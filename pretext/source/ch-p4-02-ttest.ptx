<?xml version="1.0" encoding="UTF-8"?>

<chapter xml:id="ch-ttest" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Comparing Two Means</title>

  <introduction>
    <p>
      In the previous chapter, we covered the situation when your outcome variable is a nominal
      scale, and your predictor variable is also a nominal scale. Many real-world situations have
      that character, so you'll find that chi-square tests are widely used.
    </p>

    <p>
      However, you're much more likely to find yourself in a situation where your outcome variable
      is interval scale or higher, and you're interested in whether the outcome variable's average
      value is higher in one group or another. For instance, a psychologist might want to know if
      anxiety levels are higher among parents than non-parents; or if working memory capacity is
      reduced by listening to music (relative to not listening to music). In a medical context, we
      might want to know if a new drug increases or decreases blood pressure. An agricultural
      scientist might want to know whether adding phosphorus to Australian native plants will kill
      them. In all these situations, our outcome variable is a continuous interval or ratio scale
      variable; and our predictor is a binary <q>grouping</q> variable. In other words, we want to
      compare the <em>means of the two groups</em>.
    </p>

    <p>
      The standard answer to the problem of comparing means is to use a <m>t</m>-test, which has
      several varieties depending on exactly what question you want to solve. As a consequence, the
      majority of this chapter focuses on different types of <m>t</m>-test:
    </p>

    <ul>
      <li><p>one-sample <m>t</m>-tests are discussed in <xref ref="sec-onesamplettest"/>,</p></li>
      <li><p>independent samples <m>t</m>-tests are discussed in <xref ref="sec-studentttest"/>
        and <xref ref="sec-welchttest"/>, and</p></li>
      <li><p>paired samples <m>t</m>-tests are discussed in <xref ref="sec-pairedsamplesttest"/>.</p></li>
    </ul>

    <p>
      After that, we'll talk a bit about Cohen's <m>d</m>, which is the standard measure of effect
      size for a <m>t</m>-test (<xref ref="sec-cohensd"/>).
    </p>

    <p>
      The later sections of the chapter focus on the assumptions of the <m>t</m>-tests and possible
      remedies if they are violated. However, before discussing any of these useful things, we'll
      start with a discussion of the <m>z</m>-test.
    </p>
  </introduction>

  <section xml:id="sec-ztest">
    <title>The One-Sample <m>z</m>-Test</title>

    <p>
      In this section, we'll discuss one of the most useless tests in all of statistics: the
      <term><m>z</m>-test</term>. Seriously <mdash/> this test is seldom used in real life. Its
      only real purpose is that, when teaching statistics, it's a very convenient stepping stone
      towards the <m>t</m>-test, which is probably the most (over)used tool in all statistics.
    </p>

    <p>
      Let's use a simple example to introduce the idea behind the <m>z</m>-test. A friend of
      Danielle's, Dr Zeppo, grades his introductory statistics class on a curve. Let's suppose that
      the average grade in his class is 67.5, and the standard deviation is 9.5. Of his many
      hundreds of students, it turns out that 20 of them also take psychology classes. Out of
      curiosity: do psychology students tend to get the same grades as everyone else (i.e. mean
      67.5), or do they tend to score higher or lower? Let's explore this by looking at the
      <c>zeppo.csv</c> data file by loading the file to CogStat.
    </p>

    <figure xml:id="fig-cogstatloadzeppo">
      <caption>The <c>zeppo.csv</c> data file loaded into CogStat.</caption>
      <image source="cogstatloadzeppo.png"/>
    </figure>

    <p>
      Let's explore the data a bit by looking at some summary statistics with the
      <c>Explore variable</c> function.
    </p>

    <figure xml:id="fig-cogstatexplorezeppo">
      <caption>The <c>Explore variable</c> function in CogStat.</caption>
      <image source="cogstatexplorezeppo.png"/>
    </figure>

    <p>
      The mean is <m>72.3</m>. Hm. It <em>might</em> be that the psychology students are scoring a
      bit higher than normal: that sample mean of <m>\bar{X} = 72.3</m> is a fair bit higher than
      the hypothesised population mean of <m>\mu = 67.5</m>, but on the other hand, a sample size
      of <m>N = 20</m> isn't all that big. Maybe it's pure chance.
    </p>

    <p>
      To answer the question, it helps to be able to write down what it is that we know. Firstly,
      we know that the sample mean is <m>\bar{X} = 72.3</m>. If we assume that the psychology
      students have the same standard deviation as the rest of the class, then we can say that the
      population standard deviation is <m>\sigma = 9.5</m>. We'll also assume that since Dr Zeppo
      is grading to a curve, the psychology student grades are normally distributed.
    </p>

    <p>
      Next, it helps to be clear about what we want to learn from the data. In this case, the
      research hypothesis relates to the <em>population</em> mean <m>\mu</m> for the psychology
      student grades, which is unknown. Specifically, we want to know if <m>\mu = 67.5</m> or not.
      Given that this is what we know, can we devise a hypothesis test to solve our problem? The
      data, along with the hypothesised distribution from which they are thought to arise, are shown
      in <xref ref="fig-zeppo"/>. Not entirely obvious what the right answer is, is it? For this,
      we are going to need some statistics.
    </p>

    <figure xml:id="fig-zeppo">
      <caption>The theoretical distribution (dashed green line) from which the psychology student
      grades (blue bars) are generated in CogStat at the <c>Population properties</c> section of
      our result set.</caption>
      <image source="zeppohist.png"/>
    </figure>

    <p>
      The first step in constructing a hypothesis test is to be clear about what the null and
      alternative hypotheses are. This isn't too hard to do. Our null hypothesis, <m>H_0</m>, is
      that the true population mean <m>\mu</m> for psychology student grades is 67.5; and our
      alternative hypothesis is that the population mean <em>isn't</em> 67.5. If we write this in
      mathematical notation, these hypotheses become,
      <md>
        <mrow>H_0: \amp \mu = 67.5</mrow>
        <mrow>H_1: \amp \mu \neq 67.5</mrow>
      </md>
      though to be honest, this notation doesn't add much to our understanding of the problem, it's
      just a compact way of writing down what we're trying to learn from the data. The null
      hypothesis <m>H_0</m> and the alternative hypothesis <m>H_1</m> for our test are both
      illustrated in <xref ref="fig-ztesthyp"/>. In addition to providing us with these hypotheses,
      the scenario outlined above provides us with a fair amount of background knowledge that might
      be useful. Specifically, there are two special pieces of information that we can add:
    </p>

    <ul>
      <li><p>The psychology grades are normally distributed.</p></li>
      <li><p>The true standard deviation of these scores <m>\sigma</m> is known to be 9.5.</p></li>
    </ul>

    <p>
      For the moment, we'll act as if these are absolutely trustworthy facts. In real life, this
      kind of absolutely trustworthy background knowledge doesn't exist, and so if we want to rely
      on these facts we'll just have make the <em>assumption</em> that these things are true.
      However, since these assumptions may or may not be warranted, we might need to check them.
      For now though, we'll keep things simple.
    </p>

    <figure xml:id="fig-ztesthyp">
      <caption>Graphical illustration of the null and alternative hypotheses assumed by the
      one-sample <m>z</m>-test (the two sided version, that is). The null and alternative
      hypotheses both assume that the population distribution is normal, and additionally assumes
      that the population standard deviation is known (fixed at some value <m>\sigma_0</m>). The
      null hypothesis (left) is that the population mean <m>\mu</m> is equal to some specified
      value <m>\mu_0</m>. The alternative hypothesis is that the population mean differs from this
      value, <m>\mu \neq \mu_0</m>.</caption>
      <image source="ztesthyp-1.svg"/>
    </figure>

    <p>
      The next step is to figure out what would be a good choice for a diagnostic test statistic,
      something that would help us discriminate between <m>H_0</m> and <m>H_1</m>. Given that the
      hypotheses all refer to the population mean <m>\mu</m>, you'd feel confident that the sample
      mean <m>\bar{X}</m> would be a helpful place to start. We could look at the difference between
      the sample mean <m>\bar{X}</m> and the value that the null hypothesis predicts for the
      population mean. In our example, that would mean we calculate <m>\bar{X} - 67.5</m>. More
      generally, if we let <m>\mu_0</m> refer to the value that the null hypothesis claims is our
      population mean, then we'd want to calculate
      <me>
        \bar{X} - \mu_0
      </me>
      If this quantity equals or is very close to 0, things are looking good for the null
      hypothesis. If this quantity is a long way away from 0, then it looks less likely that the
      null hypothesis is worth retaining. But how far away from zero should it be for us to
      reject <m>H_0</m>?
    </p>

    <p>
      To figure that out, we need to be a bit more sneaky, and we'll need to rely on those two
      pieces of background knowledge shared previously, namely that the raw data are normally
      distributed, and we know the value of the population standard deviation <m>\sigma</m>. If the
      null hypothesis is actually true, and the true mean is <m>\mu_0</m>, then these facts together
      mean that we know the complete population distribution of the data: a normal distribution with
      mean <m>\mu_0</m> and standard deviation <m>\sigma</m>. Adopting the notation from
      <xref ref="subsec-normal"/>, a statistician might write this as:
      <me>
        X \sim \mbox{Normal}(\mu_0,\sigma^2)
      </me>
    </p>

    <p>
      Okay, if that's true, then what can we say about the distribution of <m>\bar{X}</m>? Well,
      as we discussed earlier (see <xref ref="subsec-clt"/>), the sampling distribution of the mean
      <m>\bar{X}</m> is also normal, and has mean <m>\mu</m>. But the standard deviation of this
      sampling distribution <m>\mbox{SE}({\bar{X}})</m>, which is called the <em>standard error of
      the mean</em>, is
      <me>
        \mbox{SE}({\bar{X}}) = \frac{\sigma}{\sqrt{N}}
      </me>
    </p>

    <p>
      In other words, if the null hypothesis is true then the sampling distribution of the mean can
      be written as follows:
      <me>
        \bar{X} \sim \mbox{Normal}(\mu_0,\mbox{SE}({\bar{X}}))
      </me>
    </p>

    <p>
      Now comes the trick. What we can do is convert the sample mean <m>\bar{X}</m> into a standard
      score (<xref ref="sec-zscore"/>). This is conventionally written as <m>z</m>, but for let us
      refer to it as <m>z_{\bar{X}}</m>. (The reason for using this expanded notation is to help
      you remember that we're calculating standardised version of a sample mean, <em>not</em> a
      standardised version of a single observation, which is what a <m>z</m>-score usually refers
      to). When we do so, the <m>z</m>-score for our sample mean is
      <me>
        z_{\bar{X}} = \frac{\bar{X} - \mu_0}{\mbox{SE}({\bar{X}})}
      </me>
      or, equivalently
      <me>
        z_{\bar{X}} =  \frac{\bar{X} - \mu_0}{\sigma / \sqrt{N}}
      </me>
      This <m>z</m>-score is our test statistic. The nice thing about using this as our test
      statistic is that like all <m>z</m>-scores, it has a standard normal distribution:
      <me>
        z_{\bar{X}} \sim \mbox{Normal}(0,1)
      </me>
    </p>

    <p>
      In other words, regardless of what scale the original data are on, the <m>z</m>-statistic
      itself always has the same interpretation: it's equal to the number of standard errors that
      separate the observed sample mean <m>\bar{X}</m> from the population mean <m>\mu_0</m>
      predicted by the null hypothesis. Better yet, regardless of what the population parameters
      for the raw scores actually are, the 5% critical regions for <m>z</m>-test are always the
      same, as illustrated in <xref ref="fig-ztest1"/> and <xref ref="fig-ztest2"/>. And what this
      meant, way back in the days where people did all their statistics by hand, is that someone
      could publish a table like this:
    </p>

    <table xml:id="tbl-critical-z-values">
      <title>Critical <m>z</m> values</title>
      <tabular halign="center">
        <row header="yes" bottom="minor">
          <cell>desired <m>\alpha</m> level</cell>
          <cell>two-sided test</cell>
          <cell>one-sided test</cell>
        </row>
        <row><cell>.1</cell><cell>1.644854</cell><cell>1.281552</cell></row>
        <row><cell>.05</cell><cell>1.959964</cell><cell>1.644854</cell></row>
        <row><cell>.01</cell><cell>2.575829</cell><cell>2.326348</cell></row>
        <row><cell>.001</cell><cell>3.290527</cell><cell>3.090232</cell></row>
      </tabular>
    </table>

    <p>
      which in turn meant that researchers could calculate their <m>z</m>-statistic by hand, and
      then look up the critical value in a text book. That was an incredibly handy thing to be able
      to do back then.
    </p>

    <figure xml:id="fig-ztest1">
      <caption>Rejection regions for the one-sided <m>z</m>-test</caption>
      <image source="ztest1-1.svg"/>
    </figure>

    <figure xml:id="fig-ztest2">
      <caption>Rejection regions for the two-sided <m>z</m>-test</caption>
      <image source="ztest2-1.svg"/>
    </figure>

    <p>
      Now, as mentioned earlier, the <m>z</m>-test is almost never used in practice. However, the
      test is so incredibly simple that it's really easy to do one manually. Let's go back to the
      data from Dr Zeppo's class. However, we're not going to use CogStat for the rest of this
      section, because it will automatically (and correctly) use the population parameter estimates,
      that will actually come in handy in the <m>t</m>-test section. So from now on, let's just
      follow the logic without the urge to try to replicate it.
    </p>

    <ul>
      <li><p>The sample size is <m>20</m> (we know this from <xref ref="fig-cogstatloadzeppo"/>).</p></li>
      <li><p>The <em>mean</em> is <m>72.3</m> (we know this from <xref ref="fig-cogstatexplorezeppo"/>).</p></li>
      <li><p>The point estimation for standard deviation is <m>9.5</m> (we have to just believe this
        for the example's sake because we said so earlier).</p></li>
      <li><p>The null hypothesis is that the mean is <m>67.5</m>.</p></li>
    </ul>

    <p>
      Next, let's calculate the (true) standard error of the mean:
      <me>
        \frac{9.5}{\sqrt{20}} = 2.1243
      </me>
    </p>

    <p>
      And finally, we calculate our <m>z</m>-score:
      <me>
        \frac{72.3-67.5}{2.1243} = 2.2596
      </me>
    </p>

    <p>
      At this point, we would traditionally look up the value 2.26 in our table of critical values.
      Our original hypothesis was two-sided (we didn't really have any theory about whether
      psychology students would be better or worse at statistics than other students), so our
      hypothesis test is two-sided (or two-tailed) also.
    </p>

    <p>
      Looking at the little table shown earlier, we can see that 2.26 is bigger than the critical
      value of 1.96 that would be required to be significant at <m>\alpha = .05</m> but smaller
      than the value of 2.58 that would be required to be significant at a level of
      <m>\alpha = .01</m>. Therefore, we can conclude that we have a significant effect, which we
      might write up by saying something like this:
    </p>

    <blockquote>
      <p>
        With a mean grade of 73.2 in the sample of psychology students, and assuming a true
        population standard deviation of 9.5, we can conclude that the psychology students have
        significantly different statistics scores to the class average (<m>z = 2.26</m>,
        <m>N=20</m>, <m>p&lt;.05</m>).
      </p>
    </blockquote>

    <p>
      However, what if want an exact <m>p</m>-value? Well, back in the day, the tables of critical
      values were huge, so you could look up your actual <m>z</m>-value and find the smallest value
      of <m>\alpha</m> for which your data would be significant (which, as discussed earlier, is the
      very definition of a <m>p</m>-value). However, we are here just to discuss the
      <m>z</m>-test in order for us to understand the <m>t</m>-test, so we will not go into the
      details of how to do this. All in all, our <m>p</m>-value is <m>0.0238</m>.
    </p>

    <p>
      All statistical tests make assumptions. Some tests make reasonable assumptions, while other
      tests do not. The one-sample <m>z</m>-test makes three basic assumptions:
    </p>

    <ul>
      <li><p><em>Normality</em>. As usually described, the <m>z</m>-test assumes that the true
        population distribution is normal.<fn>Strictly speaking, the <m>z</m> test only requires
        that the sampling distribution of the mean be normally distributed; if the population is
        normal then it necessarily follows that the sampling distribution of the mean is also
        normal. However, as we saw when talking about the central limit theorem, it's entirely
        possible (even commonplace) for the sampling distribution to be normal even if the
        population distribution itself is non-normal. However, in light of the sheer ridiculousness
        of the assumption that the true standard deviation is known, there really isn't much point
        in going into details on this front!</fn> is often pretty reasonable, and not only that,
        it's an assumption that we can check if we feel worried about it.</p></li>
      <li><p><em>Independence</em>. The second assumption of the test is that the observations in
        your data set are not correlated with each other or related to each other in some funny way.
        This isn't as easy to check statistically: it relies a bit on good experimental design. An
        obvious example of something that violates this assumption is a data set where you
        <q>copy</q> the same observation over and over again in your data file: so you end up with
        a massive <q>sample size</q> consisting of only one genuine observation. More realistically,
        you have to ask yourself if it's really plausible to imagine that each observation is an
        entirely random sample from the population you're interested in. In practice, this
        assumption is never met; but we try our best to design studies that minimise the problems
        of correlated data.</p></li>
      <li><p><em>Known standard deviation</em>. The third assumption of the <m>z</m>-test is that
        the true standard deviation of the population is known to the researcher. This is just
        stupid. In no real-world data analysis problem do you know the standard deviation
        <m>\sigma</m> of some population but are completely ignorant about the mean <m>\mu</m>. In
        other words, this assumption is <em>always</em> wrong.</p></li>
    </ul>

    <p>
      In view of the stupidity of assuming that <m>\sigma</m> is known, let's see if we can live
      without it. This takes us out of the dreary domain of the <m>z</m>-test and into the magical
      kingdom of the <m>t</m>-test, with unicorns, fairies, and leprechauns.
    </p>

  </section>

  <section xml:id="sec-onesamplettest">
    <title>The One-Sample <m>t</m>-Test</title>

    <p>
      It might not be safe to assume that the psychology student grades necessarily have the same
      standard deviation as the other students in Dr Zeppo's class. After all, if we were
      entertaining the hypothesis that they don't have the same mean, why should we assume they have
      the same standard deviation? In view of this, we must stop assuming we know the true value of
      <m>\sigma</m>. However, this violates the assumptions of the <m>z</m>-test, which brings us
      back to square one. However, we still have the raw data loaded into CogStat, and those can
      give us an <em>estimate</em> of the population standard deviation.
    </p>

    <p>
      Having loaded the <c>grades</c> data and explored the descriptive statistics, let us take
      note of a few data points from the <c>Descriptives for the variable</c> and the <c>Population
      parameter estimations</c> section of the CogStat output. But first, let us re-run the
      <c>Explore variable</c> option, but now let us tell CogStat to use our null hypothesis of
      <m>67.5</m>. To do that, we have to fill in <c>67.5</c> in our dialogue:
    </p>

    <figure xml:id="fig-centraltendency">
      <caption>Setting the null hypothesis value in the <c>Explore variable</c> dialogue.</caption>
      <image source="centraltendency.png"/>
    </figure>

    <table xml:id="tbl-paramest1">
      <title>Population parameter estimations for the <c>zeppo.csv</c> data.</title>
      <tabular>
        <row header="yes" bottom="minor">
          <cell></cell>
          <cell>Point estimation</cell>
          <cell>95% confidence interval (low)</cell>
          <cell>95% confidence interval (high)</cell>
        </row>
        <row>
          <cell>Mean</cell>
          <cell>72.3</cell>
          <cell>67.8</cell>
          <cell>76.8</cell>
        </row>
        <row>
          <cell>Standard deviation</cell>
          <cell>9.5</cell>
          <cell>7.2</cell>
          <cell>13.9</cell>
        </row>
      </tabular>
    </table>

    <p>
      In other words, while we can't say that we <em>know</em> that <m>\sigma = 9.5</m>, we
      <em>can</em> say that <m>\hat\sigma = 9.5</m>. (Actually, it's <m>9.520615</m> but CogStat
      rounds it to one decimal when displayed, but it uses the exact value for any calculation.)
    </p>

    <p>
      Because we are now relying on an <em>estimate</em> of the population standard deviation, we
      need to make some adjustment for the fact that we have some uncertainty about what the true
      population standard deviation actually is. Maybe our data are just a fluke, maybe the true
      population standard deviation is 11, for instance. But if that were actually true, and we ran
      the <m>z</m>-test assuming <m>\sigma=11</m>, then the result would end up being
      <em>non-significant</em>. That's a problem, and it's one we're going to have to address.
    </p>

    <figure xml:id="fig-ttesthyponesample">
      <caption>Graphical illustration of the null and alternative hypotheses assumed by the (two
      sided) one-sample <m>t</m>-test. Note the similarity to the <m>z</m>-test. The null
      hypothesis is that the population mean <m>\mu</m> is equal to some specified value
      <m>\mu_0</m>, and the alternative hypothesis is that it is not. Like the <m>z</m>-test, we
      assume that the data are normally distributed; but we do not assume that the population
      standard deviation <m>\sigma</m> is known in advance.</caption>
      <image source="ttesthyponesample-1.svg"/>
    </figure>

    <p>
      This ambiguity is annoying, and it was resolved in 1908 by a guy called William Sealy Gosset
      (<xref ref="Student1908"/>), who was working as a chemist for the Guinness brewery at the
      time (see <xref ref="Box1987"/>). Because Guinness took a dim view of its employees publishing
      statistical analysis (apparently, they felt it was a trade secret), he published the work
      under the pseudonym <q>A Student</q>, and to this day, the full name of the <m>t</m>-test is
      actually <term>Student's <m>t</m>-test</term>. The critical thing that Gosset figured out is
      how we should accommodate the fact that we aren't entirely sure what the true standard
      deviation is.<fn>Gosset only provided a partial solution: the general solution to the problem
      was provided by Sir Ronald Fisher.</fn> The answer is that it subtly changes the sampling
      distribution.
    </p>

    <p>
      In the <m>t</m>-test, our test statistic (now called a <m>t</m>-statistic) is calculated in
      exactly the same way as mentioned above. If our null hypothesis is that the true mean is
      <m>\mu</m>, but our sample has mean <m>\bar{X}</m> and our estimate of the population
      standard deviation is <m>\hat{\sigma}</m>, then our <m>t</m> statistic is:
      <me>
        t = \frac{\bar{X} - \mu}{\hat{\sigma}/\sqrt{N} }
      </me>
    </p>

    <p>
      The only thing that has changed in the equation is that instead of using the known true value
      <m>\sigma</m>, we use the estimate <m>\hat{\sigma}</m>. And if this estimate has been
      constructed from <m>N</m> observations, then the sampling distribution turns into a
      <m>t</m>-distribution with <m>N-1</m> <term>degrees of freedom</term> (df). The
      <m>t</m> distribution is very similar to the normal distribution but has <q>heavier</q> tails,
      as discussed earlier in <xref ref="subsec-other-distributions"/> and illustrated in
      <xref ref="fig-ttestdist"/>.
    </p>

    <p>
      Notice, though, that as df gets larger, the <m>t</m>-distribution starts to look identical to
      the standard normal distribution. This is as it should be: if you have a sample size of
      <m>N = 70000000</m>, then your <q>estimate</q> of the standard deviation would be pretty much
      perfect, right? So, you should expect that for large <m>N</m>, the <m>t</m>-test would behave
      the same way as a <m>z</m>-test. And that's exactly what happens!
    </p>

    <figure xml:id="fig-ttestdist">
      <caption>The <m>t</m> distribution with 2 degrees of freedom (left) and 10 degrees of
      freedom (right), with a standard normal distribution (i.e., mean 0 and std dev 1) plotted
      as dotted lines for comparison purposes. Notice that the <m>t</m> distribution has heavier
      tails (higher kurtosis) than the normal distribution; this effect is quite exaggerated when
      the degrees of freedom are very small, but negligible for larger values. In other words, for
      large <m>df</m> the <m>t</m> distribution is essentially identical to a normal
      distribution.</caption>
      <image source="ttestdist.png"/>
    </figure>

    <p>
      As you might expect, the mechanics of the <m>t</m>-test are almost identical to the mechanics
      of the <m>z</m>-test. So there's not much point in going through the tedious exercise of
      showing you how to do the calculations: it's pretty much identical to the calculations that we
      did earlier, except that we use the estimated standard deviation, and then we test our
      hypothesis using the <m>t</m> distribution rather than the normal distribution.
    </p>

    <p>
      So let's just do it quickly in CogStat: let's just go through the output. You can see that
      the <c>Population parameter estimations</c> stayed the same, so no need to quote them here
      again. However, let's see the <c>Hypothesis tests</c> results.
    </p>

    <table xml:id="tbl-hyp4">
      <title>Hypothesis tests output for the one-sample <m>t</m>-test on the <c>zeppo.csv</c> data.</title>
      <tabular>
        <row>
          <cell>Testing if mean deviates from the value 67.5.</cell>
        </row>
        <row>
          <cell>Interval variable. &gt;&gt; Choosing one-sample t-test or Wilcoxon signed-rank test depending on the assumption.</cell>
        </row>
        <row>
          <cell>Checking for normality.</cell>
        </row>
        <row>
          <cell>Shapiro-Wilk normality test in variable x: <m>W</m> = 0.96, <m>p</m> = .586</cell>
        </row>
        <row>
          <cell>Normality is not violated. &gt;&gt; Running one-sample t-test.</cell>
        </row>
        <row>
          <cell>Sensitivity power analysis. Minimal effect size to reach 95% power with the present sample size for the present hypothesis test. Minimal effect size in d: 0.85.</cell>
        </row>
        <row>
          <cell>One sample t-test against 67.5: <m>t</m>(19) = 2.25, <m>p</m> = .036</cell>
        </row>
        <row>
          <cell>Result of the Bayesian one sample t-test: BF<m>_{10}</m> = 1.80, BF<m>_{01}</m> = 0.56</cell>
        </row>
      </tabular>
    </table>

    <p>
      Let us go through them line by line.
    </p>

    <ul>
      <li><p><c>Testing if mean deviates from the value 67.5.</c>: good, we are made sure we are
        testing against a null hypothesis of <m>\mu = 67.5</m>.</p></li>
      <li><p><c>Interval variable. &gt;&gt; Choosing one-sample t-test or Wilcoxon signed-rank test
        depending on the assumption.</c>: this means that depending on normality (which is an
        assumption of both <m>z</m> and <m>t</m>-tests), CogStat will choose either the
        <m>t</m>-test or the Wilcoxon signed-rank test. We will discuss the Wilcoxon signed-rank
        test later on.</p></li>
      <li><p><c>Normality is not violated. &gt;&gt; Running one-sample t-test.</c>: this is good,
        because we know that the <m>t</m>-test is only valid if the data are normally
        distributed.</p></li>
      <li><p><c>one-sample t-test against 67.5: t(19) = 2.25, p &lt; .036</c>: this is the result
        of the <m>t</m>-test. The <m>t</m>-statistic is 2.25, and the <m>p</m>-value is 0.036.
        This means that we can reject the null hypothesis that <m>\mu = 67.5</m> at the 5% level of
        significance. In other words, we can conclude that the mean of the sample is significantly
        different from 67.5.</p></li>
    </ul>

    <p>
      Don't forget to take note of the Mean's 95% confidence interval values from the
      <c>Population parameter estimations</c>, and now we could report the result by saying
      something like this:
    </p>

    <blockquote>
      <p>
        With a mean grade of 72.3, the psychology students scored slightly higher than the average
        grade of 67.5 (<m>t(19) = 2.25</m>, <m>p&lt;.05</m>); the 95% confidence interval is
        [67.8, 76.8].
      </p>
    </blockquote>

    <p>
      <m>t(19)</m> is shorthand notation for a <m>t</m>-statistic that has 19 degrees of freedom.
      That said, it's often the case that people don't report the confidence interval, or do so
      using a much more compressed form. For instance, it's not uncommon to see the confidence
      interval included as part of the stat block, like this:
    </p>

    <blockquote>
      <p>
        <m>t(19) = 2.25</m>, <m>p&lt;.05</m>, CI<m>_{95} = [67.8, 76.8]</m>
      </p>
    </blockquote>

    <p>
      With that much jargon crammed into half a line, you know it must be really smart.
    </p>

    <p>
      Okay, so what assumptions does the one-sample <m>t</m>-test make? Well, since the
      <m>t</m>-test is a <m>z</m>-test with the premise of known standard deviation removed, you
      shouldn't be surprised to see that it makes the same assumptions as the <m>z</m>-test, minus
      the one about the known standard deviation. That is
    </p>

    <ul>
      <li><p><em>Normality</em>. We're still assuming that the population distribution is
        normal.</p></li>
      <li><p><em>Independence</em>. Once again, we have to assume that the observations in our
        sample are generated independently of one another.</p></li>
    </ul>

    <p>
      Overall, these two assumptions aren't terribly unreasonable, and as a consequence, the
      one-sample <m>t</m>-test is pretty widely used in practice as a way of comparing a sample
      mean against a hypothesised population mean.
    </p>

  </section>

  <section xml:id="sec-studentttest">
    <title>The Independent Samples <m>t</m>-Test (Student Test)</title>

    <p>
      Although the one-sample <m>t</m>-test has its uses, it's not the most typical example of a
      <m>t</m>-test. A much more common situation arises when you've got two different groups of
      observations. In psychology, this tends to correspond to two different groups of participants,
      where each group corresponds to a different condition in your study. For each person in the
      study, you measure some outcome variable of interest, and the research question that you're
      asking is whether or not the two groups have the same population mean. This is the situation
      that the independent samples <m>t</m>-test is designed for.
    </p>

    <p>
      Suppose we have 33 students taking Dr Harpo's statistics lectures, and Dr Harpo doesn't grade
      to a curve. Actually, Dr Harpo's grading is a bit of a mystery, so we don't really know
      anything about what the average grade is for the class as a whole. There are two tutors for
      the class, Anastasia and Bernadette. There are <m>N_1 = 15</m> students in Anastasia's
      tutorials, and <m>N_2 = 18</m> in Bernadette's tutorials. The research question we're
      interested in is whether Anastasia or Bernadette is a better tutor, or if it doesn't make
      much of a difference.
    </p>

    <p>
      As usual, let's load the file <c>harpo.csv</c>.
    </p>

    <figure xml:id="fig-harpodata">
      <caption>The <c>harpo.csv</c> data file loaded into CogStat.</caption>
      <image source="cogstatloadharpo.png"/>
    </figure>

    <p>
      As we can see, we have two variables: <c>grade</c> and <c>tutor</c>. The <c>grade</c>
      variable is a numeric interval variable, containing the grades for all <m>N = 33</m> students
      taking Dr Harpo's class; the <c>tutor</c> variable is a categorical (nominal) data that
      indicates who each student's tutor was.
    </p>

    <p>
      Let's run the <c>Compare groups</c> function so we can get some information about the grades
      by tutor.
    </p>

    <figure xml:id="fig-harpocompare">
      <caption>Comparing grades by tutor in CogStat for our <c>harpo</c> data set.</caption>
      <image source="cogstatharpocomparedialog.png"/>
    </figure>

    <figure xml:id="fig-harposampleproperties">
      <caption>Sample properties for the <c>harpo</c> data set.</caption>
      <image source="cogstatharposampleproperties.png"/>
    </figure>

    <p>
      In the boxplot generated by CogStat, we have the grades, the means and corresponding upper
      and lower quartiles. We can see that the grades for Anastasia's students are slightly higher
      than those for Bernadette's students. We can also see that the variance of the grades for
      Bernadette's students is slightly higher than that for Anastasia's students.
    </p>

    <figure xml:id="fig-harpoboxplot">
      <caption>Boxplot of grades by tutor for the <c>harpo</c> data set.</caption>
      <image source="cogstatharpoboxplot.png"/>
    </figure>

    <p>
      The <term>independent samples <m>t</m>-test</term> comes in two different forms, Student's
      and Welch's. The original Student <m>t</m>-test <mdash/> which is the one we'll describe in
      this section <mdash/> is the simpler of the two but relies on much more restrictive
      assumptions than the Welch <m>t</m>-test. Assuming for the moment that you want to run a
      two-sided test, the goal is to determine whether two <q>independent samples</q> of data are
      drawn from populations with the same mean (the null hypothesis) or different means (the
      alternative hypothesis).
    </p>

    <p>
      When we say <q>independent</q> samples, what we really mean here is that there's no special
      relationship between observations in the two samples. This probably doesn't make a lot of
      sense right now, but it will be clearer when we come to talk about the paired samples
      <m>t</m>-test later on. For now, let's just point out that if we have an experimental design
      where participants are randomly allocated to one of two groups, and we want to compare the
      two groups' mean performance on some outcome measure, then an independent samples
      <m>t</m>-test (rather than a paired samples <m>t</m>-test) is what we're after.
    </p>

    <p>
      Okay, so let's let <m>\mu_1</m> denote the true population mean for group 1 (e.g., Anastasia's
      students), and <m>\mu_2</m> will be the true population mean for group 2 (e.g., Bernadette's
      students),<fn>A funny question almost always pops up at this point: what the heck <em>is</em>
      the population being referred to in this case? Is it the set of students actually taking
      Dr Harpo's class (all 33 of them)? The set of people who might take the class (an unknown
      number) of them? Or something else? Does it matter which of these we pick? Technically yes,
      it does matter: if you change your definition of what the <q>real world</q> population
      actually is, then the sampling distribution of your observed mean <m>\bar{X}</m> changes too.
      The <m>t</m>-test relies on the assumption that the observations are sampled at random from an
      infinitely large population, and to the extent that real life isn't like that, then the
      <m>t</m>-test can be wrong. In practice, however, this isn't usually a big deal: even though
      the assumption is almost always wrong, it doesn't lead to a lot of pathological behaviour from
      the test, so we tend to just ignore it.</fn> and as usual, we'll let <m>\bar{X}_1</m> and
      <m>\bar{X}_2</m> denote the observed sample means for both of these groups. Our null
      hypothesis states that the two population means are identical (<m>\mu_1 = \mu_2</m>), and the
      alternative to this is that they are not (<m>\mu_1 \neq \mu_2</m>).
      <md>
        <mrow>H_0: \amp \mu_1 = \mu_2</mrow>
        <mrow>H_1: \amp \mu_1 \neq \mu_2</mrow>
      </md>
    </p>

    <figure xml:id="fig-ttesthyp">
      <caption>Graphical illustration of the null and alternative hypotheses assumed by the Student
      <m>t</m>-test. The null hypothesis assumes that both groups have the same mean <m>\mu</m>,
      whereas the alternative assumes that they have different means <m>\mu_1</m> and <m>\mu_2</m>.
      Notice that it is assumed that the population distributions are normal, and that, although the
      alternative hypothesis allows the group to have different means, it assumes they have the same
      standard deviation.</caption>
      <image source="ttesthyp-1.svg"/>
    </figure>

    <p>
      To construct a hypothesis test that handles this scenario, we start by noting that if the null
      hypothesis is true, then the difference between the population means is <em>exactly</em> zero,
      <m>\mu_1 - \mu_2 = 0</m>
    </p>

    <p>
      As a consequence, a diagnostic test statistic will be based on the difference between the two
      sample means. Because if the null hypothesis is true, then we'd expect
      <me>
        \bar{X}_1 - \bar{X}_2
      </me>
      to be <em>pretty close</em> to zero. However, just like we saw with our one-sample tests
      (i.e. the one-sample <m>z</m>-test and the one-sample <m>t</m>-test) we have to be precise
      about exactly <em>how close</em> to zero this difference should be. And the solution to the
      problem is more or less the same one: we calculate a standard error estimate (SE), just like
      last time, and then divide the difference between means by this estimate. So our
      <term><m>t</m>-statistic</term> will be of the form
      <me>
        t = \frac{\bar{X}_1 - \bar{X}_2}{\mbox{SE}}
      </me>
      We just need to figure out what this standard error estimate actually is. This is a bit
      trickier than was the case for either of the two tests we've looked at so far, so we need to
      go through it a lot more carefully to understand how it works.
    </p>

    <p>
      In the original <q>Student <m>t</m>-test</q>, we make the assumption that the two groups have
      the same population standard deviation: that is, regardless of whether the population means
      are the same, we assume that the population standard deviations are identical,
      <m>\sigma_1 = \sigma_2</m>. Since we're assuming that the two standard deviations are the
      same, we drop the subscripts and refer to both of them as <m>\sigma</m>.
    </p>

    <p>
      How should we estimate this? How should we construct a single estimate of a standard deviation
      when we have two samples? The answer is, we take a <em>weighed</em> average of the
      <em>variance</em> estimates, which we use as our <term>pooled estimate of the variance</term>.
      The weight assigned to each sample is equal to the number of observations in that sample,
      minus 1.
      <md>
        <mrow>w_1 \amp= N_1 - 1</mrow>
        <mrow>w_2 \amp= N_2 - 1</mrow>
      </md>
    </p>

    <p>
      Now that we've assigned weights to each sample, we calculate the pooled estimate of the
      variance by taking the weighted average of the two variance estimates, <m>{\hat\sigma_1}^2</m>
      and <m>{\hat\sigma_2}^2</m>.
      <me>
        \hat\sigma^2_p = \frac{w_1 {\hat\sigma_1}^2 + w_2 {\hat\sigma_2}^2}{w_1 + w_2}
      </me>
    </p>

    <p>
      Finally, we convert the pooled variance estimate to a pooled standard deviation estimate, by
      taking the square root. This gives us the following formula for <m>\hat\sigma_p</m>,
      <me>
        \hat\sigma_p = \sqrt{\frac{w_1 {\hat\sigma_1}^2 + w_2 {\hat\sigma_2}^2}{w_1 + w_2}}
      </me>
    </p>

    <p>
      And if you mentally substitute <m>w_1 = N_1 -1</m> and <m>w_2 = N_2 -1</m> into this
      equation, you get a very ugly formula that actually seems to be the <q>standard</q> way of
      describing the pooled standard deviation estimate.
    </p>

    <p>
      But let us describe it a bit differently:
    </p>

    <p>
      Our data set actually corresponds to a set of <m>N</m> observations, which are sorted into
      two groups. So let's use the notation <m>X_{ik}</m> to refer to the grade received by the
      <m>i</m>-th student in the <m>k</m>-th tutorial group: that is, <m>X_{11}</m> is the grade
      received by the first student in Anastasia's class, <m>X_{21}</m> is her second student, and
      so on. And we have two separate group means <m>\bar{X}_1</m> and <m>\bar{X}_2</m>, which we
      could <q>generically</q> refer to using the notation <m>\bar{X}_k</m>, i.e., the mean grade
      for the <m>k</m>-th tutorial group. Since every single student falls into one of the two
      tutorials, and so we can describe their deviation from the group mean as the difference
      <me>
        X_{ik} - \bar{X}_k
      </me>
    </p>

    <p>
      So why not just use these deviations (i.e. the extent to which each student's grade differs
      from the mean grade in their tutorial)? Remember, a variance is just the average of a bunch
      of squared deviations.
      <me>
        \frac{\sum_{ik} \left( X_{ik} - \bar{X}_k \right)^2}{N}
      </me>
      where the notation <q><m>\sum_{ik}</m></q> is a lazy way of saying <q>calculate a sum by
      looking at all students in all tutorials</q>, since each <q><m>ik</m></q> corresponds to one
      student. But, as we saw in <xref ref="sec-estimating-parameters"/>, calculating the variance
      by dividing by <m>N</m> produces a biased estimate of the population variance. And previously,
      we needed to divide by <m>N-1</m> to fix this. However, the reason why this bias exists is
      because the variance estimate relies on the sample mean; and to the extent that the sample
      mean isn't equal to the population mean, it can systematically bias our estimate of the
      variance. But this time we're relying on <em>two</em> sample means! Does this mean that we've
      got more bias? Yes, yes it does. And does this mean we now need to divide by <m>N-2</m>
      instead of <m>N-1</m>, in order to calculate our pooled variance estimate? Why, yes...
      <me>
        \hat\sigma^2_p = \frac{\sum_{ik} \left( X_{ik} - \bar{X}_k \right)^2}{N -2}
      </me>
      Oh, and if you take the square root of this then you get <m>\hat{\sigma}_p</m>, the pooled
      standard deviation estimate. In other words, the pooled standard deviation calculation is
      nothing special: it's not terribly different to the regular standard deviation calculation.
    </p>

    <p>
      Regardless of which way you want to think about it, we now have our pooled estimate of the
      standard deviation. From now on, we'll refer to this estimate as <m>\hat\sigma</m>. Let's now
      go back to thinking about the hypothesis test.
    </p>

    <p>
      Our whole reason for calculating this pooled estimate was that we knew it would be helpful
      when calculating our <em>standard error</em> estimate. But, standard error of <em>what</em>?
      In the one-sample <m>t</m>-test, it was the standard error of the sample mean,
      <m>\mbox{SE}({\bar{X}})</m>, and since <m>\mbox{SE}({\bar{X}}) = \sigma / \sqrt{N}</m>
      that's what the denominator of our <m>t</m>-statistic looked like. This time around, however,
      we have <em>two</em> sample means. And what we're interested in, specifically, is the the
      difference between the two <m>\bar{X}_1 - \bar{X}_2</m>. Consequently, the standard error
      that we need to divide by is in fact the <term>standard error of the difference</term> between
      means. As long as the two variables really do have the same standard deviation, then our
      estimate for the standard error is
      <me>
        \mbox{SE}({\bar{X}_1 - \bar{X}_2}) = \hat\sigma \sqrt{\frac{1}{N_1} + \frac{1}{N_2}}
      </me>
      and our <m>t</m>-statistic is therefore
      <me>
        t = \frac{\bar{X}_1 - \bar{X}_2}{\mbox{SE}({\bar{X}_1 - \bar{X}_2})}
      </me>
    </p>

    <p>
      Just as we saw with our one-sample test, the sampling distribution of this <m>t</m>-statistic
      is a <m>t</m>-distribution as long as the null hypothesis is true, and all of the assumptions
      of the test are met. The degrees of freedom, however, is slightly different. As usual, we can
      think of the degrees of freedom to be equal to the number of data points minus the number of
      constraints. In this case, we have <m>N</m> observations (<m>N_1</m> in sample 1, and
      <m>N_2</m> in sample 2), and 2 constraints (the sample means). So the total degrees of
      freedom for this test are <m>N-2</m>.
    </p>

    <figure xml:id="fig-cogstatharpohypo">
      <caption>Hypothesis test output in CogStat for the <c>harpo.csv</c> data.</caption>
      <image source="cogstatharpohypo.png"/>
    </figure>

    <p>
      The output from CogStat has a very familiar form. Let's start to talk about the confidence
      interval, and for that, let's circle back to our <c>Population parameter estimations</c>:
    </p>

    <table xml:id="tbl-paramest2">
      <title>Population parameter estimations for the <c>harpo.csv</c> data.</title>
      <tabular>
        <row header="yes" bottom="minor">
          <cell>tutor</cell>
          <cell>Point estimation</cell>
          <cell>95% CI (low)</cell>
          <cell>95% CI (high)</cell>
        </row>
        <row>
          <cell>Anastasia</cell>
          <cell>74.5</cell>
          <cell>69.5</cell>
          <cell>79.5</cell>
        </row>
        <row>
          <cell>Bernadette</cell>
          <cell>69.1</cell>
          <cell>66.2</cell>
          <cell>71.9</cell>
        </row>
        <row>
          <cell>Difference between the two groups:</cell>
          <cell>5.5</cell>
          <cell>0.2</cell>
          <cell>10.8</cell>
        </row>
      </tabular>
    </table>

    <p>
      It's pretty important to be clear on what this confidence interval actually refers to: it is
      a confidence interval for the <em>difference</em> between the group means. In our example,
      Anastasia's students had an average grade of 74.5, and Bernadette's students had an average
      grade of 69.1, so the difference between the two sample means is 5.5 (due to rounding). But
      of course the difference between population means might be bigger or smaller than this. The
      confidence interval reported tells you that there's a 95% chance that the true difference
      between means lies between 0.2 and 10.8.
    </p>

    <p>
      In any case, the difference between the two groups is significant (just barely), so we might
      write up the result using text like this:
    </p>

    <blockquote>
      <p>
        The mean grade in Anastasia's class was 74.5 (SD = 8.7), whereas the mean in Bernadette's
        class was 69.1 (SD = 5.6). A Student's independent samples <m>t</m>-test showed that this
        5.5 difference was significant (<m>t(31) = 2.12</m>, <m>p&lt;.05</m>,
        <m>CI_{95} = [0.2, 10.8]</m>), suggesting that a genuine difference in learning outcomes
        has occurred.
      </p>
    </blockquote>

    <p>
      At a bare minimum, you'd expect to see the <m>t</m>-statistic, the degrees of freedom and the
      <m>p</m> value. So you should include something like this at a minimum: <m>t(31) = 2.1</m>,
      <m>p&lt;.05</m>. If statisticians had their way, everyone would also report the confidence
      interval and probably the effect size measure too, because they are useful things to know.
      But real life doesn't always work the way statisticians want it to: you should make a judgment
      based on whether you think it will help your readers, and (if you're writing a scientific
      paper) the editorial standard for the journal in question. Some journals expect you to report
      effect sizes, others don't. Within some scientific communities it is standard practice to
      report confidence intervals, in other it is not. You'll need to figure out what your audience
      expects.
    </p>

    <p>
      Before moving on to talk about the assumptions of the <m>t</m>-test, there's one additional
      point to make about the use of <m>t</m>-tests in practice. The first one relates to the sign
      of the <m>t</m>-statistic (that is, whether it is a positive number or a negative one). One
      very common worry that students have when they start running their first <m>t</m>-test is that
      they often end up with negative values for the <m>t</m>-statistic, and don't know how to
      interpret it. On closer inspection, the students will notice that the confidence intervals
      also have the opposite signs. This is perfectly okay. The <m>t</m>-statistic calculated in
      CogStat is always of the form
      <me>
        t = \frac{\mbox{(mean 1)} -\mbox{(mean 2)}}{ \mbox{(SE)}}
      </me>
      If <q>mean 1</q> is larger than <q>mean 2</q> the <m>t</m> statistic will be positive,
      whereas if <q>mean 2</q> is larger then the <m>t</m> statistic will be negative. Similarly,
      the confidence interval is the confidence interval for the difference <q>(mean 1) minus
      (mean 2)</q>, which will be the reverse of what you'd get if you were calculating the
      confidence interval for the difference <q>(mean 2) minus (mean 1)</q>.
    </p>

    <p>
      Okay, that's pretty straightforward when you think about it, but now consider our
      <m>t</m>-test comparing Anastasia's class to Bernadette's class. Which one does CogStat call
      <q>mean 1</q> and which one should we call <q>mean 2</q>? Let's look at the order of how the
      data is presented. Anastasia goes first in all the result outputs. So, we would write
    </p>

    <blockquote>
      <p>Anastasia's class had <em>higher</em> grades than Bernadette's class
      (<m>t(31)= 2.1, p=.04</m>).</p>
    </blockquote>

    <p>
      On the other hand, suppose the phrasing we wanted to use has Bernadette's class listed first.
      If so, it makes more sense to treat her class as group 1, and if so, the write up looks like
      this:
    </p>

    <blockquote>
      <p>Bernadette's class had <em>lower</em> grades than Anastasia's class
      (<m>t(31)= -2.1, p=.04</m>).</p>
    </blockquote>

    <p>
      Because we're talking about one group having <q>lower</q> scores this time around, it is more
      sensible to use the negative form of the <m>t</m>-statistic. It just makes it read more
      cleanly.
    </p>

    <p>
      One last thing: please note that you <em>can't</em> do this for other types of test
      statistics. It works for <m>t</m>-tests, but it wouldn't be meaningful for chi-square tests,
      <m>F</m>-tests. So don't overgeneralise this advice!
    </p>

    <p>
      As always, our hypothesis test relies on some assumptions. For the Student t-test there are
      three assumptions, some of which we saw previously in the context of the one-sample
      <m>t</m>-test:
    </p>

    <ul>
      <li><p><em>Normality</em>. Specifically, we assume that both groups are normally
        distributed.</p></li>
      <li><p><em>Independence</em>. In the context of the Student test, this has two aspects to it.
        Firstly, we assume that the observations within each sample are independent of one another
        (exactly the same as for the one-sample test). However, we also assume that there are no
        cross-sample dependencies. If, for instance, it turns out that you included some participants
        in both experimental conditions of your study (e.g. by accidentally allowing the same person
        to sign up to different conditions), then there are some cross sample dependencies that
        you'd need to take into account.</p></li>
      <li><p><em>Homogeneity of variance</em> (also called <q>homoscedasticity</q>). The third
        assumption is that the population standard deviation is the same in both groups. CogStat
        tests this assumption using the Levene test automatically, as you've seen in the result
        output. But we'll talk about the test later on in the book.</p></li>
    </ul>

  </section>

</chapter>
