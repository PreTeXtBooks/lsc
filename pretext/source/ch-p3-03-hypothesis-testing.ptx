<?xml version="1.0" encoding="UTF-8"?>

<chapter xml:id="ch-hypothesis-testing" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Hypothesis Testing</title>

  <introduction>
    <p>
      In <xref ref="ch-sampling"/>, we discussed the ideas behind estimation, which is one of the
      two <q>big ideas</q> in inferential statistics. It's now time to turn our attention to the
      other big idea, which is <term>hypothesis testing</term>. In its most abstract form,
      hypothesis testing is really a very simple idea: the researcher has some theory about the
      world and wants to determine whether or not the data actually support that theory. However,
      the details are messy, and most people find the theory of hypothesis testing to be the most
      frustrating part of statistics.
    </p>

    <p>
      The structure of the chapter is as follows. Firstly, we'll talk about how hypothesis testing
      works in a fair amount of detail, using a simple running example to show you how a hypothesis
      test is <q>built</q>. We'll focus on the underlying logic of the testing procedure rather than
      being too dogmatic about it. Afterwards, we'll spend a bit of time talking about the dogmas,
      rules and heresies surrounding the hypothesis testing theory.
    </p>
  </introduction>

  <section xml:id="sec-hypotheses">
    <title>A Menagerie of Hypotheses</title>

    <p>
      Eventually, we all succumb to madness. Let's suppose that this glorious day has come, and we
      indulge in a most thoroughly unproductive line of psychological research: the search for
      extrasensory perception (ESP).<fn>My apologies to anyone who actually believes in this stuff,
      but on my reading of the literature on ESP, it's just not reasonable to think this is real.
      To be fair, though, some of the studies are rigorously designed; so it's actually an
      interesting area for thinking about psychological research design. And of course, it's a free
      country, so you can spend your own time and effort proving me wrong if you like, but I
      wouldn't think that's a terribly practical use of your intellect. <mdash/> Danielle</fn> Our
      first study is a simple one in which we seek to test whether clairvoyance exists. Each
      participant sits down at a table and is shown a card by an experimenter. The card is black on
      one side and white on the other. The experimenter takes the card away and places it on a table
      in an adjacent room. The card is placed black side up or white side up entirely at random,
      with the randomisation occurring after the experimenter has left the room with the
      participant. A second experimenter comes in and asks the participant which side of the card is
      now facing upwards. It's purely a one-shot experiment. Each person sees only one card and
      gives only one answer. At no stage is the participant in contact with someone who knows the
      correct answer.
    </p>

    <p>
      The data set, therefore, is very simple. We have asked the question of, say, <m>N = 100</m>
      people and <m>X = 62</m> of these people have given the correct response. It's a surprisingly
      large number, sure, but is it large enough for us to feel safe in claiming we've found
      evidence for ESP? This is the situation where hypothesis testing comes in useful. However,
      before we talk about how to <em>test</em> hypotheses, we need to be clear about what we mean
      by hypotheses.
    </p>

    <subsection xml:id="subsec-research-vs-statistical">
      <title>Research Hypotheses versus Statistical Hypotheses</title>

      <p>
        The first distinction that you need to keep clear in your mind is between research
        hypotheses and statistical hypotheses. In our ESP study, the overall scientific goal is to
        demonstrate that clairvoyance exists. In this situation, we have a clear research goal: we
        are hoping to discover evidence for ESP. In other cases, we might be a lot more neutral than
        that, so we might say our goal is to determine whether or not clairvoyance exists.
        Regardless of how we want to portray it, the basic point that we're trying to convey here
        is that a research hypothesis involves making a substantive, testable scientific claim. If
        you are a psychologist, your research hypotheses are fundamentally <em>about</em>
        psychological constructs. Any of the following would count as <term>research
        hypotheses</term>:
      </p>

      <ul>
        <li><p><em>Listening to music reduces your ability to pay attention to other things.</em>
        This is a claim about the causal relationship between two psychologically meaningful
        concepts (listening to music and paying attention to things), so it's a perfectly reasonable
        research hypothesis.</p></li>
        <li><p><em>Intelligence is related to personality</em>. Like the last one, this is a
        relational claim about two psychological constructs (intelligence and personality), but the
        claim is weaker: correlational, not causal.</p></li>
        <li><p><em>Intelligence is the speed of information processing</em>. This hypothesis has
        quite a different character: it's not a relational claim at all. It's an ontological claim
        about the fundamental character of intelligence.</p></li>
      </ul>

      <p>
        Notice that in practice, our research hypotheses could overlap a lot. The ultimate goal in
        the ESP experiment might be to test an ontological claim like <q>ESP exists</q>. But we
        might operationally restrict ourselves to a narrower hypothesis like <q>Some people can
        'see' objects in a clairvoyant fashion</q>. That said, some things really don't count as
        proper research hypotheses in any meaningful sense:
      </p>

      <ul>
        <li><p><em>Love is a battlefield</em>. This is too vague to be testable. While it's okay
        for a research hypothesis to have a degree of vagueness to it, it has to be possible to
        operationalise your theoretical ideas.</p></li>
        <li><p><em>The first rule of the tautology club is the first rule of the tautology
        club</em>. This is not a substantive claim of any kind. It's true by definition. No
        conceivable state of nature could possibly be inconsistent with this claim. As such, we say
        this is an <em>unfalsifiable</em> hypothesis, and as such, it is outside the domain of
        science.</p></li>
        <li><p><em>More people in my experiment will say "yes" than "no"</em>. This one fails as a
        research hypothesis because it's a claim about the data set, not about psychology (unless,
        of course, your actual research question is whether people have some kind of <q>yes</q>
        bias!).</p></li>
      </ul>

      <p>
        As you can see, research hypotheses can be somewhat messy at times; and ultimately, they
        are <em>scientific</em> claims. <term>Statistical hypotheses</term> are neither of these two
        things. They must be mathematically precise and correspond to specific claims about the
        characteristics of the <q>population</q>. Even so, the intent is that statistical hypotheses
        clearly relate to the substantive research hypotheses you care about! For instance, in our
        ESP study, the research hypothesis is that some people are able to see through walls or
        whatever. We want to <q>map</q> this onto a statement about how the data were generated. So
        let's think about what that statement would be. The quantity that we'd be interested in
        within the experiment is <m>P(\text{"correct"})</m>, the true-but-unknown probability with
        which the participants in my experiment answer the question correctly. Let's use the Greek
        letter <m>\theta</m> (theta) to refer to this probability. Here are four different
        statistical hypotheses:
      </p>

      <ul>
        <li><p>If ESP doesn't exist and if the experiment is well designed, then the participants
        are just guessing. So we should expect them to get it right half of the time, and so the
        statistical hypothesis is that the true probability of choosing correctly is
        <m>\theta = 0.5</m>.</p></li>
        <li><p>Alternatively, suppose ESP does exist, and participants can see the card. If that's
        true, people will perform better than chance. The statistical hypothesis would be that
        <m>\theta > 0.5</m>.</p></li>
        <li><p>A third possibility is that ESP does exist, but the colours are all reversed, and
        people don't realise it. If that's how it works, then you'd expect people's performance to
        be <em>below</em> chance. This would correspond to a statistical hypothesis that
        <m>\theta &lt; 0.5</m>.</p></li>
        <li><p>Finally, suppose ESP exists, but we have no idea whether people are seeing the right
        colour or the wrong one. In that case, the only claim to be made about the data would be
        that the probability of making the correct answer is <em>not</em> equal to 50. This
        corresponds to the statistical hypothesis that <m>\theta \neq 0.5</m>.</p></li>
      </ul>

      <p>These are legitimate examples of statistical hypotheses because they are statements about a
       population parameter and are meaningfully related to my experiment. What this discussion hopefully
       makes clear is that when attempting to construct a statistical hypothesis test, the researcher has
       two quite distinct hypotheses to consider. They have a research hypothesis (a claim about psychology)
       corresponding to a statistical hypothesis (a claim about the data generating population).</p>
      <table xml:id="tbl-esp-hypotheses">
        <title>Research and statistical hypotheses in our ESP research example.</title>
        <tabular halign="center">
          <row header="yes" bottom="minor">
            <cell>Research hypothesis</cell>
            <cell>Statistical hypothesis</cell>
          </row>
          <row>
            <cell>ESP exists</cell>
            <cell><m>\theta \neq 0.5</m></cell>
          </row>
        </tabular>
      </table>

      <p>
        And the critical thing to recognise is this: <em>a statistical hypothesis test is a test of
        the statistical hypothesis, not the research hypothesis</em>. If your study is poorly
        designed, the link between your research hypothesis and your statistical hypothesis is
        broken. To give a silly example, suppose that the ESP study was conducted in a situation where
        the participant can actually see the card reflected in a window; if that happens, we would be able
        to find robust evidence that <m>\theta \neq 0.5</m>, but this would tell us nothing about whether
        "ESP exists".
      </p>

    </subsection>

    <subsection xml:id="subsec-null-alternative">
      <title>Null Hypotheses and Alternative Hypotheses</title>

      <p>
        We have a research hypothesis that corresponds to the question we want to ask about the
        world, and we can map it onto a statistical hypothesis. Our statistical hypothesis will have
        a claim. This claim will become our <q>alternative</q> hypothesis, <m>H_1</m>. In contrast,
        the <q>null</q> hypothesis, <m>H_0</m>, will correspond to the exact opposite of what the
        claim was. Then, we'll focus exclusively on the null hypothesis.
      </p>

      <p>
        In our ESP example, the null hypothesis is that <m>\theta = 0.5</m>, since that's what
        we'd expect if ESP <em>didn't</em> exist. The hope, of course, is that ESP is totally real,
        and so the <em>alternative</em> to this null hypothesis is <m>\theta \neq 0.5</m>. In
        essence, what we're doing here is dividing up the possible values of <m>\theta</m> into two
        groups: those values that we really hope aren't true (the null) and those values that we'd
        be happy with if they turn out to be correct (the alternative). Having done so, the
        important thing to recognise is that the goal of a hypothesis test is <em>not</em> to show
        that the alternative hypothesis is (probably) true; the goal is to show that the null
        hypothesis is (probably) false. Most people find this pretty weird.
      </p>

      <p>
        According to Danielle, the best way to think about it is to imagine that a hypothesis test
        is a criminal trial: <em>the trial of the null hypothesis</em>. The null hypothesis is the
        defendant, the researcher is the prosecutor, and the statistical test itself is the judge.
        Just like a criminal trial, there is a presumption of innocence: the null hypothesis is
        <em>deemed</em> to be true unless you, the researcher, can prove beyond a reasonable doubt
        that it is false.
        You are free to design your experiment however you like (within reason, obviously!), and your
        goal when doing so is to maximise the chance that the data will yield a conviction for the crime
        of being false. The catch is that the statistical test sets the rules of the trial, which are
        designed to protect the null hypothesis â€“ specifically to ensure that if the null hypothesis is
        true, the chances of a false conviction are guaranteed to be low. This is pretty important:
        after all, the null hypothesis doesn't get a lawyer. And given that the researcher is trying
        desperately to prove it to be false, someone has to protect it.
      </p>

    </subsection>

  </section>

  <section xml:id="sec-error-types">
    <title>Two Types of Errors</title>

    <p>
      Ideally, we would like to construct our test so that we never make any errors.
      Unfortunately, this is never possible. Sometimes you're just really unlucky: for instance,
      suppose you flip a coin 10 times in a row and it comes up heads all 10 times. That feels like
      powerful evidence that the coin is biased (and it is!), but of course, there's a 1 in 1024
      chance that this would happen even if the coin was totally fair. In other words, in real life,
      we <em>always</em> have to accept that there's a chance that we did the wrong thing.
      Consequently, statistical hypothesis testing aims not to <em>eliminate</em> errors but to
      <em>minimise</em> them.
    </p>

    <p>
      At this point, we need to be more precise about what we mean by <q>errors</q>. Firstly,
      let's state the obvious: it is either the case that the null hypothesis is true, or it is
      false. And our test will either reject the null hypothesis or retain it. So, as the table
      below illustrates, after we run the test and make our choice, one of four things might have
      happened:
    </p>

    <table xml:id="tbl-error-types-simple">
      <title>Decision outcomes in hypothesis testing</title>
      <tabular halign="center">
        <row header="yes" bottom="minor">
          <cell></cell>
          <cell>Retain <m>H_0</m></cell>
          <cell>Reject <m>H_0</m></cell>
        </row>
        <row>
          <cell><m>H_0</m> is true</cell>
          <cell>Correct decision</cell>
          <cell>Error (type I)</cell>
        </row>
        <row>
          <cell><m>H_0</m> is false</cell>
          <cell>Error (type II)</cell>
          <cell>Correct decision</cell>
        </row>
      </tabular>
    </table>

    <p>
      As a consequence, there are actually <em>two</em> different types of error here. If we reject
      a null hypothesis that is actually true, then we have made a <term>type I error</term>. On the
      other hand, if we retain the null hypothesis when it is, in fact, false, then we have made a
      <term>type II error</term>.
    </p>

    <p>
      A criminal trial requires that you establish <q>beyond a reasonable doubt</q> that the
      defendant did it. The trial is designed to protect the rights of a defendant. In other words,
      a criminal trial doesn't treat the two types of error in the same way: punishing the innocent
      is deemed to be much worse than letting the guilty go free. A statistical test is pretty much
      the same: the single most important design principle of the test is to <em>control</em> the
      probability of a type I error to keep it below some fixed probability. This probability, which
      is denoted <m>\alpha</m>, is called the <term>significance level</term> of the test (or
      sometimes, the <em>size</em> of the test). A hypothesis test is said to have a significance
      level <m>\alpha</m> if the type I error rate is no larger than <m>\alpha</m>.
    </p>

    <p>
      So, what about the type II error rate? Well, we'd also like to keep those under control too,
      and we denote this probability by <m>\beta</m>. However, it's much more common to refer to
      the <term>power</term> of the test, which is the probability with which we reject a null
      hypothesis when it is false, which is <m>1-\beta</m>. To help keep this straight, here's the
      same table again, but with the relevant numbers added:
    </p>

    <table xml:id="tbl-error-types-full">
      <title>Decision outcomes with probabilities</title>
      <tabular halign="center">
        <row header="yes" bottom="minor">
          <cell></cell>
          <cell>Retain <m>H_0</m></cell>
          <cell>Reject <m>H_0</m></cell>
        </row>
        <row>
          <cell><m>H_0</m> is true</cell>
          <cell><m>1-\alpha</m> (probability of correct retention)</cell>
          <cell><m>\alpha</m> (type I error rate)</cell>
        </row>
        <row>
          <cell><m>H_0</m> is false</cell>
          <cell><m>\beta</m> (type II error rate)</cell>
          <cell><m>1-\beta</m> (power of the test)</cell>
        </row>
      </tabular>
    </table>

    <p>
      A <q>powerful</q> hypothesis test has a small value of <m>\beta</m> while still keeping
      <m>\alpha</m> fixed at some (small) desired level. By convention, scientists make use of three
      different <m>\alpha</m> levels: <m>.05</m>, <m>.01</m> and <m>.001</m>. Notice the asymmetry
      here: the tests are designed to <em>ensure</em> that the <m>\alpha</m> level is kept small,
      but there's no corresponding guarantee regarding <m>\beta</m>. We'd certainly <em>like</em>
      the type II error rate to be small, and we try to design tests that keep it small, but this
      is very much secondary to the overwhelming need to control the type I error rate. Paraphrasing
      Blackstone had he been a statistician: it is <q>better to retain ten false null hypotheses
      than to reject a single true one</q>.
    </p>

  </section>

  <section xml:id="sec-test-statistics">
    <title>Test Statistics and Sampling Distributions</title>

    <p>
      At this point, we need to start talking specifics about how to construct a hypothesis test.
      To that end, let's return to the ESP example. Let's ignore the actual data we obtained, for
      the moment, and think about the structure of the experiment. Regardless of the actual numbers,
      the <em>form</em> of the data is that <m>X</m> out of <m>N</m> people correctly identified
      the colour of the hidden card. Moreover, let's suppose for the moment that the null hypothesis
      really is true: ESP doesn't exist, and the true probability that anyone picks the correct
      colour is exactly <m>\theta = 0.5</m>. What would we <em>expect</em> the data to look like?
      Well, obviously, we'd expect the proportion of people who make the correct response to be
      pretty close to 50%. Or, to phrase this in more mathematical terms, we'd say that <m>X/N</m>
      is approximately <m>0.5</m>. Of course, we wouldn't expect this fraction to be
      <em>exactly</em> 0.5: if, for example, we tested <m>N=100</m> people, and <m>X = 53</m> of
      them got the question right, we'd probably be forced to concede that the data are quite
      consistent with the null hypothesis. On the other hand, if <m>X = 99</m> of our participants
      got the question right, then we'd feel pretty confident that the null hypothesis is wrong.
      Similarly, if only <m>X=3</m> people got the answer right, we'd be similarly confident that the
      null was wrong. Let's be a little more technical about this: we have a quantity <m>X</m> that
      we can calculate by looking at our data; after looking at the value of <m>X</m>, we decide
      whether to believe that the null hypothesis is correct or to reject the null hypothesis in
      favour of the alternative. The name for this thing that we calculate to guide our choices is a
      <term>test statistic</term>.
      Having chosen a test statistic, now the next step is to state precisely which values of the
      test statistic would cause us to reject the null hypothesis and which values would cause us to
      keep it. To do so, we need to determine what the <term>sampling distribution of the test
      statistic</term> would be if the null hypothesis were true. Why do we need this? Because this
      distribution tells us precisely what values of <m>X</m>, our null hypothesis would lead us to
      expect. And therefore, we can use this distribution to assess how closely the null hypothesis
      agrees with our data.
    </p>

    <figure xml:id="fig-samplingdist">
      <caption>The sampling distribution for our test statistic <m>X</m> when the null hypothesis
      is true. For our ESP scenario, this is a binomial distribution. Not surprisingly, since the
      null hypothesis says that the probability of a correct response is <m>\theta = .5</m>, the
      sampling distribution says that the most likely value is 50 (out of 100) correct responses.
      Most of the probability mass lies between 40 and 60.</caption>
      <image source="samplingdist-1.svg" width="70%"/>
    </figure>

    <p>
      How do we determine the sampling distribution of the test statistic? Fortunately, our ESP
      example provides us with one of the most uncomplicated cases. Our population parameter
      <m>\theta</m> is just the overall probability that people respond correctly when asked the
      question, and our test statistic <m>X</m> is the <em>count</em> of the number of people who
      did so out of a sample size of <m>N</m>. We've seen a distribution like this in
      <xref ref="subsec-binomial"/>: that's exactly what the binomial distribution describes! So,
      to use the notation and terminology introduced in that section, we would say that the null
      hypothesis predicts that <m>X</m> is binomially distributed, which is written
      <me>
        X \sim \text{Binomial}(\theta,N)
      </me>
    </p>

    <p>
      Since the null hypothesis states that <m>\theta = 0.5</m> and our experiment has <m>N=100</m>
      people, we have the sampling distribution we need. This sampling distribution is plotted in
      <xref ref="fig-samplingdist"/>. No surprises, really: the null hypothesis says that
      <m>X=50</m> is the most likely outcome, and it says that we're almost certain to see somewhere
      between 40 and 60 correct responses.
    </p>

  </section>

  <section xml:id="sec-decision-making">
    <title>Making Decisions</title>

    <p>
      We've constructed a test statistic (<m>X</m>), and we chose it so that we're pretty confident
      that if <m>X</m> is close to <m>N/2</m>, then we should retain the null, and if not, we
      should reject it. The question remains: exactly which values of the test statistic should we
      associate with the null hypothesis, and which values go with the alternative hypothesis? In
      the ESP study, for example, we've observed a value of <m>X=62</m>. What decision should we
      make? Should we choose to believe the null hypothesis or the alternative hypothesis?
    </p>

    <subsection xml:id="subsec-critical-regions">
      <title>Critical Regions and Critical Values</title>

      <p>
        To answer this question, we need to introduce the concept of a <term>critical region</term>
        for the test statistic <m>X</m>. The critical region of the test corresponds to those values
        of <m>X</m> that would lead us to reject the null hypothesis. How do we find this critical
        region? Well, let's consider what we know:
      </p>

      <ul>
        <li><p><m>X</m> should be very big or very small to reject the null hypothesis.</p></li>
        <li><p>If the null hypothesis is true, the sampling distribution of <m>X</m> is Binomial<m>(0.5, N)</m>.</p></li>
        <li><p>If <m>\alpha =.05</m>, the critical region must cover 5% of this sampling distribution.</p></li>
      </ul>

      <p>
        You must understand this last point: the critical region corresponds to those values of
        <m>X</m> for which we would reject the null hypothesis, and the sampling distribution in
        question describes the probability that we would obtain a particular value of <m>X</m> if
        the null hypothesis were actually true.
      </p>

      <p>
        Now, let's suppose that we chose a critical region that covers 20% of the sampling
        distribution, and assume that the null hypothesis is actually true. What would be the
        probability of incorrectly rejecting the null? The answer is, of course, 20%. And therefore,
        we would have built a test that had an <m>\alpha</m> level of <m>0.2</m>. If we want
        <m>\alpha = .05</m>, the critical region is only <em>allowed</em> to cover 5% of the
        sampling distribution of our test statistic.
      </p>

      <figure xml:id="fig-crit2">
        <caption>The critical region associated with the hypothesis test for the ESP study, for a
        hypothesis test with a significance level of <m>\alpha = .05</m>. The plot shows the
        sampling distribution of <m>X</m> under the null hypothesis: the grey bars correspond to
        those values of <m>X</m>, for which we would retain the null hypothesis. The black bars show
        the critical region: those values of <m>X</m> for which we would reject the null. Because
        the alternative hypothesis is two-sided (i.e. allows both <m>\theta &lt;.5</m> and
        <m>\theta >.5</m>), the critical region covers both tails of the distribution. To ensure an
        <m>\alpha</m> level of <m>.05</m>, we need to ensure that each of the two regions
        encompasses 2.5% of the sampling distribution.</caption>
        <image source="crit2-1.svg" width="70%"/>
      </figure>

      <p>
        As it turns out, those three things uniquely solve the problem: our critical region consists
        of the most <em>extreme values</em>, known as the <term>tails</term> of the distribution
        (illustrated in <xref ref="fig-crit2"/>). As it turns out, if we want <m>\alpha = .05</m>,
        then our critical regions correspond to <m>X \leq 40</m> and <m>X \geq 60</m>. If the
        number of people saying <q>true</q> is between 41 and 59, we should retain the null
        hypothesis. We should reject the null hypothesis if the number is between 0 to 40 or between
        60 to 100. The numbers 40 and 60 are often referred to as the <term>critical values</term>
        since they define the edges of the critical region.
      </p>

      <p>
        At this point, our hypothesis test is essentially complete:
        <ol>
          <li><p>we choose an <m>\alpha</m> level (e.g. <m>\alpha = .05</m>),</p></li>
          <li><p>we come up with some test statistic (e.g., <m>X</m>) that does a good job (in some meaningful sense) of comparing <m>H_0</m> to <m>H_1</m>,</p></li>
          <li><p>we figure out the sampling distribution of the test statistic on the assumption that the null hypothesis is true (in this case, binomial) and then</p></li>
          <li><p>we calculate the critical region that produces an appropriate <m>\alpha</m> level (0<ndash/>40 and 60<ndash/>100).</p></li>
        </ol>
      </p>

      <p>
        Now, we have to calculate the value of the test statistic for the real data (e.g.,
        <m>X = 62</m>) and then compare it to the critical values to make our decision. Since 62 is
        greater than the critical value of 60, we would reject the null hypothesis. Or, to phrase
        it slightly differently, we say that the test has produced a <term>significant</term> result.
      </p>

    </subsection>

    <subsection xml:id="subsec-statistical-significance">
      <title>A Note on Statistical <q>Significance</q></title>

      <p>
        A very brief digression is in order regarding the word <q>significant</q>. It is a
        misnomer. The concept of statistical significance is very simple, but has a very unfortunate
        name. If the data allows us to reject the null hypothesis, we say that <q>the result is
        <em>statistically significant</em></q>, often shortened to <q>the result is
        significant</q>. This terminology dates back to a time when <q>significant</q> just meant
        something like <q>indicated</q> rather than its modern meaning, which is much closer to
        <q>important</q>. As a result, many modern readers get very confused when they start
        learning statistics because they think a <q>significant result</q> must be an important one.
        It doesn't mean that at all. All that <q>statistically significant</q> means is that the
        data allowed us to reject a null hypothesis.
        Whether or not the result is actually important in the real world is a very different question
        and depends on all sorts of other things.
      </p>

    </subsection>

    <subsection xml:id="subsec-one-vs-two-sided">
      <title>The Difference between One-Sided and Two-Sided Tests</title>

      <p>
        There's one more thing to point out about the constructed hypothesis test. Let us take a
        moment to think about the statistical hypotheses:
        <md>
          <mrow>H_0 : \amp \theta = .5</mrow>
          <mrow>H_1 : \amp \theta \neq .5</mrow>
        </md>
      </p>

      <p>
        We notice that the alternative hypothesis covers <em>both</em> the possibility that
        <m>\theta &lt; .5</m> and the possibility that <m>\theta > .5</m>. This makes sense if we
        think ESP could produce better-than-chance performance <em>or</em> worse-than-chance
        performance. This is an example of a <term>two-sided test</term> in statistical language.
        It's called this because the alternative hypothesis covers the area on both <q>sides</q> of
        the null hypothesis. As a consequence, the critical region of the test covers both tails of
        the sampling distribution (2.5% on either side provided that <m>\alpha =.05</m>), as
        illustrated earlier in <xref ref="fig-crit2"/>.
      </p>

      <p>
        However, that's not the only possibility. For example, it might be the case that we're only
        willing to believe in ESP if it produces better than chance performance. If so, then the
        alternative hypothesis would only cover the possibility that <m>\theta > .5</m>, and as a
        consequence, the null hypothesis now becomes <m>\theta \leq .5</m>:
        <md>
          <mrow>H_0 : \amp \theta \leq .5</mrow>
          <mrow>H_1 : \amp \theta > .5</mrow>
        </md>
      </p>

      <p>
        When this happens, we have what's called a <term>one-sided test</term>, and when this
        happens, the critical region only covers one tail of the sampling distribution. This is
        illustrated in <xref ref="fig-crit1"/>.
      </p>

      <figure xml:id="fig-crit1">
        <caption>The critical region for a one sided test. In this case, the alternative hypothesis
        is that <m>\theta > .05</m>, so we would only reject the null hypothesis for large values
        of <m>X</m>. As a consequence, the critical region only covers the upper tail of the
        sampling distribution; specifically the upper 5% of the distribution. Contrast this to the
        two-sided version earlier.</caption>
        <image source="crit1-1.svg" width="70%"/>
      </figure>

    </subsection>

  </section>

  <section xml:id="sec-pvalue">
    <title>The <m>p</m> Value of a Test</title>

    <p>
      In one sense, our hypothesis test is complete; we've constructed a test statistic, figured out
      its sampling distribution if the null hypothesis is true, and then constructed the critical
      region for the test. Nevertheless, we've actually omitted the most important number of all:
      <term>the <m>p</m> value</term>. It is to this topic that we now turn.
    </p>

    <p>
      There are two somewhat different ways of interpreting a <m>p</m> value, one proposed by Sir
      Ronald Fisher and the other by Jerzy Neyman. Both versions are legitimate, though they reflect
      very different ways of thinking about hypothesis tests. Most introductory textbooks only give
      Fisher's version, but that's a bit of a shame. Danielle believes Neyman's version is cleaner
      and that it better reflects the logic of the null hypothesis test. You might disagree, though,
      so both are included. We'll start with Neyman's version.
    </p>

    <subsection xml:id="subsec-soft-decision">
      <title>A Softer View of Decision Making</title>

      <p>
        One problem with the hypothesis testing procedure is that it makes no distinction between a
        <q>barely significant</q> and a <q>highly significant</q> result. For instance, in the ESP
        study, the data only just fell inside the critical region <mdash/> so we did get a
        significant effect, but it was a pretty near thing. In contrast, suppose we run a study in
        which <m>X=97</m> out of the <m>N=100</m> participants got the answer right. This would
        obviously be significant, too, but by a much larger margin. There is no real ambiguity about
        this at all. The procedure makes no distinction between the two. If we adopt the standard
        convention of allowing <m>\alpha = .05</m> as an acceptable Type I error rate, then both are
        significant results.
      </p>

      <p>
        This is where the <m>p</m> value comes in handy. To understand how it works, let's suppose
        that we ran many hypothesis tests on the same data set: but with a different value of
        <m>\alpha</m> in each case. When we do that for our ESP data, what we'd get is something
        like this:
      </p>

      <table xml:id="tbl-alpha-table">
        <title>Hypothesis test results for different <m>\alpha</m> levels</title>
        <tabular halign="left">
          <row header="yes" bottom="minor">
            <cell>Value of <m>\alpha</m></cell>
            <cell>Reject the null?</cell>
          </row>
          <row><cell>0.05</cell><cell>Yes</cell></row>
          <row><cell>0.04</cell><cell>Yes</cell></row>
          <row><cell>0.03</cell><cell>Yes</cell></row>
          <row><cell>0.02</cell><cell>No</cell></row>
          <row><cell>0.01</cell><cell>No</cell></row>
        </tabular>
      </table>

      <p>
        When we test ESP data (<m>X=62</m> successes out of <m>N=100</m> observations) using
        <m>\alpha</m> levels of .03 and above, we always reject the null hypothesis. We always
        retain the null hypothesis for <m>\alpha</m> levels of .02 and below. Therefore, somewhere
        between .02 and .03, there must be the smallest value of <m>\alpha</m> that would allow us
        to reject the null hypothesis for this data. This is the <m>p</m> value; as it turns out
        the ESP data has <m>p = .021</m>. In short:
      </p>

      <blockquote>
        <p>
          <m>p</m> is defined to be the smallest Type I error rate (<m>\alpha</m>) that you have to
          be willing to tolerate if you want to reject the null hypothesis.
        </p>
      </blockquote>

      <p>
        If it turns out that <m>p</m> describes an error rate that you find intolerable, then you
        must retain the null. If you're comfortable with an error rate equal to <m>p</m>, then it's
        okay to reject the null hypothesis in favour of your preferred alternative.
      </p>

      <p>
        In effect, <m>p</m> is a summary of all the possible hypothesis tests you could have run,
        taken across all possible <m>\alpha</m> values. And as a consequence, it has the effect of
        <q>softening</q> our decision process. For those tests in which <m>p \leq \alpha</m>, you
        would have rejected the null hypothesis, whereas for those tests in which <m>p > \alpha</m>,
        you would have retained the null.
      </p>

      <p>
        In our ESP study, we obtained <m>X=62</m>, and as a consequence we've ended up with
        <m>p = .021</m>. So the error rate we have to tolerate is 2.1%. In contrast, suppose the
        experiment had yielded <m>X=97</m>. What happens to the <m>p</m> value now? This time it's
        shrunk to <m>p = 1.36 \times 10^{-25}</m>, which is a tiny, tiny<fn>That's
        <m>p = .000000000000000000000000136</m> for folks that don't like or know scientific
        notation!</fn> Type I error rate. For this second case, we would be able to reject the null
        hypothesis with a lot more confidence because we only have to be <q>willing</q> to tolerate
        a type I error rate of about 1 in 10 trillion trillion to justify our decision to reject.
      </p>

    </subsection>

    <subsection xml:id="subsec-extreme-data">
      <title>The Probability of Extreme Data</title>

      <p>
        The second definition of the <m>p</m>-value comes from Sir Ronald Fisher, which you tend to
        see in most introductory statistics textbooks. Notice how, when we constructed the critical
        region, it corresponded to the <em>tails</em> (i.e. extreme values) of the sampling
        distribution? That's not a coincidence: almost all <q>good</q> tests have this
        characteristic. The reason for that is that a good critical region almost always corresponds
        to those values of the test statistic that are least likely to be observed if the null
        hypothesis is true. If this rule is true, then we can define the <m>p</m>-value as the
        probability that we would have observed a test statistic that is at least as extreme as the
        one we actually did get.
      </p>

      <p>
        In other words, if the data are extremely implausible according to the null hypothesis, then
        the null hypothesis is probably wrong.
      </p>

    </subsection>

    <subsection xml:id="subsec-common-mistake">
      <title>A Common Mistake</title>

      <p>
        You can see that there are two somewhat different but legitimate ways to interpret the
        <m>p</m> value, one based on Neyman's approach to hypothesis testing and the other based on
        Fisher's. Unfortunately, there is a third explanation that people sometimes give, especially
        when they're first learning statistics, and it is <em>absolutely and completely wrong</em>.
        This mistaken approach is to refer to the <m>p</m> value as <q>the probability that the
        null hypothesis is true</q>. It's an intuitively appealing way to think, but it's wrong in
        two key respects:
      </p>

      <ol>
        <li><p>null hypothesis testing is a frequentist tool, and the frequentist approach to
        probability does <em>not</em> allow you to assign probabilities to the null hypothesis.
        According to this view of probability, the null hypothesis is either true or not, but it
        cannot have a <q>5% chance</q> of being true.</p></li>
        <li><p>even within the Bayesian approach, which does let you assign probabilities to
        hypotheses, the <m>p</m> value would not correspond to the probability that the null is
        true; this interpretation is entirely inconsistent with the mathematics of how the <m>p</m>
        value is calculated.</p></li>
      </ol>

      <p>
        Put bluntly, despite the intuitive appeal of thinking this way, there is <em>no</em>
        justification for interpreting a <m>p</m> value this way. Never do it.
      </p>

    </subsection>

  </section>

  <section xml:id="sec-reporting-results">
    <title>Reporting the Results of a Hypothesis Test</title>

    <p>
      When writing up the results of a hypothesis test, there are usually several pieces of
      information that you need to report, but it varies a fair bit from test to test. In the
      chapters discussing each statistical tool, we'll spend a little time talking about how to
      report the results correctly. However, regardless of what test you're doing, the one thing
      that you always have to do is say something about the <m>p</m> value and whether or not the
      outcome was significant.
    </p>

    <p>
      The fact that you have to do this is unsurprising: it's the whole point of doing the test. It
      might be surprising, though, that there is some contention over exactly how you're supposed to
      do it. Leaving aside those people who completely disagree with the entire framework underpinning
      null hypothesis testing, there's a certain amount of tension that exists regarding whether or
      not to report the exact <m>p</m> value that you obtained, or if you should state only that
      <m>p &lt; \alpha</m> for a significance level that you chose in advance (e.g.,
      <m>p &lt; .05</m>).
    </p>

    <subsection xml:id="subsec-reporting-issue">
      <title>The Issue</title>

      <p>
        To see why this is an issue, the key thing to recognise is that <m>p</m> values are
        <em>terribly</em> convenient. In practice, the fact that we can compute a <m>p</m> value
        means that we don't have to specify any <m>\alpha</m> level at all to run the test. Instead,
        what you can do is calculate your <m>p</m> value and interpret it directly: if you get
        <m>p = .062</m>, then it means that you'd have to be willing to tolerate a Type I error rate
        of 6.2% to justify rejecting the null. If you personally find 6.2% intolerable, then you
        retain the null.
      </p>

      <p>
        Therefore, the argument goes, why don't we just report the actual <m>p</m> value and let the
        reader make up their own minds about what an acceptable Type I error rate is? This approach
        has the big advantage of <q>softening</q> the decision-making process <mdash/> in fact, if
        you accept the Neyman definition of the <m>p</m> value, that's the whole point of the
        <m>p</m> value. We no longer have a fixed significance level of <m>\alpha = .05</m> as a
        bright line separating <q>accept</q> from <q>reject</q> decisions; and this removes the
        rather pathological problem of being forced to treat <m>p = .051</m> in a fundamentally
        different way to <m>p = .049</m>.
      </p>

      <p>
        This flexibility is both the advantage and the disadvantage to the <m>p</m> value. Many
        people don't like the idea of reporting an exact <m>p</m> value because it gives the
        researcher a bit <em>too much</em> freedom. In particular, it lets you change your mind
        about what error tolerance you're willing to put up with <em>after</em> you look at the
        data.
      </p>

      <p>
        For instance, consider the ESP experiment. Suppose we ran the test and ended up with a
        <m>p</m> value of .09. Should we accept or reject? Now, we haven't yet bothered to think
        about what level of Type I error we're <q>really</q> willing to accept. But we <em>do</em>
        have an opinion about whether or not ESP exists. Regardless, we could always decide that a
        9% error rate isn't so bad, especially compared to how annoying it would be to admit to the
        world that the experiment has failed. So, to avoid looking like we just made it up after the
        fact, we now say that our <m>\alpha</m> is .1: a 10% type I error rate isn't too bad, and at
        that level, our test is significant! We win.
      </p>

      <p>
        In other words, the worry here is that we might have the best of intentions and be the most
        honest of people, but the temptation to just <q>shade</q> things a little bit here and there
        is really, really strong. Anyone who has ever run an experiment can attest that it's a long
        and difficult process, and you often get <em>very</em> attached to your hypotheses. It's hard
        to let go and admit the experiment didn't find what you wanted it to find. And that's the
        danger here. If we use the <q>raw</q> <m>p</m>-value, people will start interpreting the
        data in terms of what they <em>want</em> to believe, not what the data are actually saying.
        And if we allow that, well, why are we bothering to do science at all? Why not let everyone
        believe whatever they like about anything, regardless of what the facts are? Okay, that's a
        bit extreme, but that's where the worry comes from. According to this view, you really
        <em>must</em> specify your <m>\alpha</m> value in advance and then only report whether the
        test was significant or not. It's the only way to keep ourselves honest.
      </p>

    </subsection>

    <subsection xml:id="subsec-two-solutions">
      <title>Two Proposed Solutions</title>

      <p>
        In practice, it's pretty rare for a researcher to specify a single <m>\alpha</m> level ahead
        of time. Instead, the convention is that scientists rely on three standard significance
        levels: .05, .01 and .001. When reporting your results, you indicate which (if any) of these
        significance levels allow you to reject the null hypothesis. This is summarised in
        <xref ref="tbl-pval-table"/>. This allows us to soften the decision rule a little bit since
        <m>p &lt; .01</m> implies that the data meet a stronger evidentiary standard than
        <m>p &lt; .05</m> would. Nevertheless, since these levels are fixed in advance by convention,
        it does prevent people from choosing their <m>\alpha</m> level after looking at the data.
      </p>

      <table xml:id="tbl-pval-table">
        <title>A commonly adopted convention for reporting <m>p</m> values. A <q>significance
        stars</q> notation (i.e., a * indicates <m>p &lt; .05</m>) is sometimes produced by
        statistical software. It's also worth noting that some people will write <em>n.s.</em>
        (not significant) rather than <m>p > .05</m>.</title>
        <tabular halign="left">
          <row header="yes" bottom="minor">
            <cell>Usual notation</cell>
            <cell>Signif. stars</cell>
            <cell>Meaning</cell>
            <cell>The null is...</cell>
          </row>
          <row>
            <cell><m>p > .05</m></cell>
            <cell></cell>
            <cell>The test wasn't significant</cell>
            <cell>Retained</cell>
          </row>
          <row>
            <cell><m>p &lt; .05</m></cell>
            <cell>*</cell>
            <cell>The test was significant at <m>\alpha = .05</m> but not at <m>\alpha = .01</m> or <m>\alpha = .001</m>.</cell>
            <cell>Rejected</cell>
          </row>
          <row>
            <cell><m>p &lt; .01</m></cell>
            <cell>**</cell>
            <cell>The test was significant at <m>\alpha = .05</m> and <m>\alpha = .01</m> but not at <m>\alpha = .001</m></cell>
            <cell>Rejected</cell>
          </row>
          <row>
            <cell><m>p &lt; .001</m></cell>
            <cell>***</cell>
            <cell>The test was significant at all levels</cell>
            <cell>Rejected</cell>
          </row>
        </tabular>
      </table>

      <p>
        Nevertheless, many people still prefer to report exact <m>p</m> values. To many people, the
        advantage of allowing the reader to make up their own mind about how to interpret
        <m>p = .06</m> outweighs any disadvantages. In practice, however, even among those
        researchers who prefer exact <m>p</m> values, it is quite common to just write
        <m>p &lt; .001</m> instead of reporting an exact value for small <m>p</m>. This is in part
        because a lot of software doesn't actually print out the <m>p</m> value when it's that small
        (e.g., SPSS just writes <m>p = .000</m> whenever <m>p &lt; .001</m>), and in part because a
        very small <m>p</m> value can be kind of misleading. The human mind sees a number like
        .0000000001, and it's hard to suppress the gut feeling that the evidence in favour of the
        alternative hypothesis is a near certainty. In practice, however, this is usually wrong.
        Every statistical test ever invented relies on simplifications, approximations and
        assumptions. As a consequence, it's probably not reasonable to walk away from <em>any</em>
        statistical analysis with a feeling of confidence stronger than <m>p &lt; .001</m> implies.
        In other words, <m>p &lt; .001</m> is really code for <q>as far as <em>this test</em> is
        concerned, the evidence is overwhelming.</q>
      </p>

      <p>
        In light of all this, you might wonder what exactly you should do. There's a fair bit of
        contradictory advice on the topic, with some people arguing that you should report the exact
        <m>p</m> value and other people arguing that you should use the tiered approach illustrated
        in <xref ref="tbl-pval-table"/>. As a result, the best advice is that you look at
        papers/reports written in your field and see what the convention seems to be. If there
        doesn't seem to be any consistent pattern, then use whichever method you prefer.
      </p>

      <p>
        For any hypothesis test that CogStat will run for you, whether that be a t-test, ANOVA,
        regression, etc., the output will include a <m>p</m> value. If you want to report the
        <m>p</m> value, you can just copy and paste it from the output.
      </p>

    </subsection>

  </section>

  <section xml:id="sec-effect-size">
    <title>Effect Size, Sample Size and Power</title>

    <p>
      In previous sections, we emphasised the fact that the major design principle behind
      statistical hypothesis testing is that we try to control our Type I error rate. When we fix
      <m>\alpha = .05</m>, we are attempting to ensure that only 5% of true null hypotheses are
      incorrectly rejected. However, this doesn't mean that we don't care about Type II errors. In
      fact, from the researcher's perspective, the error of failing to reject the null when it is
      actually false is an extremely annoying one. With that in mind, a secondary goal of hypothesis
      testing is to try to minimise <m>\beta</m>, the Type II error rate, although we don't usually
      <em>talk</em> in terms of minimising Type II errors. Instead, we talk about maximising the
      <em>power</em> of the test. Since power is defined as <m>1-\beta</m>, this is the same thing.
    </p>

    <subsection xml:id="subsec-power-function">
      <title>The Power Function</title>

      <figure xml:id="fig-crit3">
        <caption>Sampling distribution under the <em>alternative</em> hypothesis, for a population
        parameter value of <m>\theta = 0.55</m>. A reasonable proportion of the distribution lies
        in the rejection region.</caption>
        <image source="crit3-1.svg" width="70%"/>
      </figure>

      <p>
        Let's take a moment to think about what a Type II error actually is. A Type II error occurs
        when the alternative hypothesis is true, but we are nevertheless unable to reject the null
        hypothesis. Ideally, we'd be able to calculate a single number <m>\beta</m> that tells us
        the Type II error rate, similarly to how we can set <m>\alpha = .05</m> for the Type I
        error rate. Unfortunately, this is a lot trickier to do.
      </p>

      <p>
        To see this, notice that in the ESP study, the alternative hypothesis actually corresponds
        to lots of possible values of <m>\theta</m>. In fact, the alternative hypothesis corresponds
        to every value of <m>\theta</m> <em>except</em> 0.5. Let's suppose that the true
        probability of someone choosing the correct response is 55% (i.e., <m>\theta = .55</m>). If
        so, then the <em>true</em> sampling distribution for <m>X</m> is not the same one that the
        null hypothesis predicts: the most likely value for <m>X</m> is now 55 out of 100. Not only
        that, the whole sampling distribution has now shifted, as shown in
        <xref ref="fig-crit3"/>. The critical regions, of course, do not change: by definition, the
        critical regions are based on what the null hypothesis predicts. What we're seeing in this
        figure is the fact that when the null hypothesis is wrong, a much larger proportion of the
        sampling distribution falls in the critical region. And, of course, that's what should
        happen: the probability of rejecting the null hypothesis is larger when the null hypothesis
        is actually false! However, <m>\theta = 0.55</m> is not the only possibility that is consistent
        with the alternative hypothesis.
      </p>

      <p>
        Let's instead suppose that the true value of <m>\theta</m> is 0.7. What happens to the
        sampling distribution when this occurs? The answer, shown in <xref ref="fig-crit4"/>, is
        that almost the entirety of the sampling distribution has now moved into the critical region.
        Therefore, if <m>\theta = 0.7</m>, the probability of us correctly rejecting the null
        hypothesis (i.e. the power of the test) is much larger than if <m>\theta = 0.55</m>.
        In short, while <m>\theta = 0.55</m> and <m>\theta = 0.7</m> are both part of the alternative
        hypothesis, the Type II error rate is different.
      </p>

      <figure xml:id="fig-crit4">
        <caption>Sampling distribution under the <em>alternative</em> hypothesis, for a population
        parameter value of <m>\theta = 0.70</m>. Almost all of the distribution lies in the
        rejection region.</caption>
        <image source="crit4-1.svg" width="70%"/>
      </figure>

      <figure xml:id="fig-powerfunction">
        <caption>The probability that we will reject the null hypothesis is plotted as a function
        of the true value of <m>\theta</m>. Obviously, the test is more powerful (greater chance
        of correct rejection) if the true value of <m>\theta</m> is very different from the value
        that the null hypothesis specifies (i.e., <m>\theta=.5</m>). Notice that when <m>\theta</m>
        actually is equal to .5 (plotted as a black dot), the null hypothesis is, in fact, true:
        rejecting the null hypothesis in this instance would be a Type I error.</caption>
        <image source="powerfunction-1.svg" width="70%"/>
      </figure>

      <p>
        This means that the power of a test (i.e., <m>1-\beta</m>) depends on the true value of
        <m>\theta</m>. To illustrate this, we've calculated the expected probability of rejecting
        the null hypothesis for all values of <m>\theta</m> and plotted it in
        <xref ref="fig-powerfunction"/>. This plot describes what is usually called the
        <term>power function</term> of the test. It's a nice summary of how good the test is because
        it actually tells you the power (<m>1-\beta</m>) for all possible values of <m>\theta</m>.
        As you can see, when the true value of <m>\theta</m> is very close to 0.5, the power of the
        test drops very sharply, but when it is further away, the power is large.
      </p>

    </subsection>

    <subsection xml:id="subsec-effect-size">
      <title>Effect Size</title>

      <p>
        The plot shown in <xref ref="fig-powerfunction"/> captures a basic point about hypothesis
        testing. If the true state of the world is very different from what the null hypothesis
        predicts, then your power will be very high; but if the true state of the world is similar
        to the null (but not identical), then the power of the test is going to be very low.
        Therefore, it's useful to be able to have some way of quantifying how <q>similar</q> the
        true state of the world is to the null hypothesis. A statistic that does this is called a
        measure of <term>effect size</term>.
      </p>

      <p>
        Effect size is defined slightly differently in different contexts, but the qualitative idea
        that it tries to capture is always the same: how big is the difference between the
        <em>true</em> population parameters and the parameter values that are assumed by the null
        hypothesis.
      </p>

      <p>
        In our ESP example, if we let <m>\theta_0 = 0.5</m> denote the value assumed by the null
        hypothesis, and let <m>\theta</m> denote the true value, then a simple measure of effect
        size could be something like the difference between the true value and null (i.e.,
        <m>\theta - \theta_0</m>), or possibly just the magnitude of this difference,
        <m>\text{abs}(\theta - \theta_0)</m>.
      </p>

      <table xml:id="tbl-effect-size-table">
        <title>Effect size and significance</title>
        <tabular halign="center">
          <row header="yes" bottom="minor">
            <cell></cell>
            <cell>Big effect size</cell>
            <cell>Small effect size</cell>
          </row>
          <row>
            <cell><term>Significant result</term></cell>
            <cell>difference is real, and of practical importance</cell>
            <cell>difference is real, but might not be interesting</cell>
          </row>
          <row>
            <cell><term>Non-significant result</term></cell>
            <cell>no effect observed</cell>
            <cell>no effect observed</cell>
          </row>
        </tabular>
      </table>

      <p>
        Why calculate effect size? Let's assume that you've run your experiment, collected the data,
        and gotten a significant effect when you ran your hypothesis test. Isn't it enough just to
        say that you've gotten a significant effect? Surely that's the <em>point</em> of hypothesis
        testing? Well, sort of. Yes, the point of doing a hypothesis test is to try to demonstrate
        that the null hypothesis is wrong, but that's hardly the only thing we're interested in.
      </p>

      <p>
        If the null hypothesis claimed that <m>\theta = .5</m>, and we show that it's wrong, we've
        only really told half of the story. Rejecting the null hypothesis implies that we believe
        that <m>\theta \neq .5</m>, but there's a big difference between <m>\theta = .51</m> and
        <m>\theta = .8</m>. If we find that <m>\theta = .8</m>, then not only have we found that
        the null hypothesis is wrong, it appears to be <em>very</em> wrong.
      </p>

      <p>
        On the other hand, suppose we've successfully rejected the null hypothesis, but it looks
        like the true value of <m>\theta</m> is only .51 (this would only be possible with a large
        study). Sure, the null hypothesis is wrong, but it's not at all clear that we actually
        <em>care</em>, because the effect size is so small.
      </p>

      <p>
        In the context of the ESP study, we might still care, since any demonstration of real
        psychic powers would actually be pretty cool,<fn>Although, in practice, a very small effect
        size is worrying because even very minor methodological flaws might be responsible for the
        effect. And in practice, no experiment is perfect, so there are always methodological issues
        to worry about.</fn> but in other contexts, a 1% difference isn't
        very interesting, even if it is a real difference.
      </p>

      <p>
        For instance, suppose we're looking at differences in high school exam scores between males
        and females, and it turns out that the female scores are 1% higher on average than the
        males. If I've got data from thousands of students, then this difference will almost
        certainly be <em>statistically significant</em>, but regardless of how small the <m>p</m>
        value is, it's just not very interesting. You'd hardly want to go around proclaiming a
        crisis in boys' education based on such a tiny difference, would you? For this reason, it
        is becoming more standard (slowly but surely) to report some kind of
        standard measure of effect size along with the results of the hypothesis test. The hypothesis
        test itself tells you whether you should believe that the effect you have observed is real
        (i.e., not just due to chance); the effect size tells you whether or not you should care.
      </p>

    </subsection>

    <subsection xml:id="subsec-power-increase">
      <title>Increasing the Power of Your Study</title>

      <p>
        Not surprisingly, scientists are fairly obsessed with maximising the power of their
        experiments. We want our experiments to work, so we want to maximise the chance of rejecting
        the null hypothesis if it is false (and we usually want to believe it is false!).
      </p>

      <p>
        As we've seen, one factor that influences power is the <em>effect size</em>. So the first
        thing you can do to increase your power is to increase the effect size. In practice, this
        means that you want to design your study so that the effect size gets magnified. For
        instance, in the ESP study, we might believe that psychic powers work best in a quiet,
        darkened room; with fewer distractions to cloud the mind. Therefore, we would try to conduct
        the experiments in such an environment. If we can strengthen people's ESP abilities somehow,
        then the true value of <m>\theta</m> will go up<fn>Notice that the true population parameter
        <m>\theta</m> doesn't necessarily correspond to an immutable fact of nature. In this context,
        <m>\theta</m> is just the true probability that people would correctly guess the colour of
        the card in the other room. As such, the population parameter can be influenced by all sorts
        of things. Of course, this is all on the assumption that ESP actually exists!</fn> and,
        therefore, our effect size will be larger. In short, clever experimental design is one way
        to boost power; because it can alter the effect size.
      </p>

      <p>
        Unfortunately, it's often the case that even with the best experimental designs, you may
        have only a small effect. Perhaps, for example, ESP really does exist, but even under the
        best of conditions, it's very very weak. Under those circumstances, your best bet for
        increasing power is to increase the sample size. Generally, the more observations you have
        available, the more likely you can discriminate between two hypotheses.
      </p>

      <p>
        If we had 10 participants, and 7 of them correctly guessed the colour of the hidden card,
        you wouldn't be terribly impressed. But if we had 10,000 participants and 7,000 of them got
        the answer right, you would likely think we had discovered something. In other words, power
        increases with the sample size. This is illustrated in <xref ref="fig-powerfunctionsample"/>,
        which shows the power of the test for a true parameter of <m>\theta = 0.7</m>, for all
        sample sizes <m>N</m> from 1 to 100, where I'm assuming that the null hypothesis predicts
        that <m>\theta_0 = 0.5</m>.
      </p>

      <figure xml:id="fig-powerfunctionsample">
        <caption>The power of our test, plotted as a function of the sample size <m>N</m>. In this
        case, the true value of <m>\theta</m> is 0.7, but the null hypothesis is that
        <m>\theta = 0.5</m>. Overall, larger <m>N</m> means greater power. (The small zig-zags in
        this function occur because of some odd interactions between <m>\theta</m>, <m>\alpha</m>
        and the fact that the binomial distribution is discrete; it doesn't matter for any serious
        purpose)</caption>
        <image source="powerfunctionsample-1.svg" width="70%"/>
      </figure>

      <p>
        Because power is important, it would be pretty useful to know how much power you're likely
        to have when you're contemplating running an experiment. It's never possible to know for
        sure since you can't possibly know what your effect size is. However, it's sometimes
        possible to guess how big it should be. If so, you can guess what sample size you need! This
        idea is called <term>power analysis</term>. If it's feasible to do it, it's very helpful
        since it can tell you whether you have enough time or money to run the experiment
        successfully. It's increasingly common to see people arguing that power analysis should be
        a required part of experimental design, so it's worth knowing about, but we won't be
        discussing it in this book in detail.
      </p>

    </subsection>

  </section>

  <section xml:id="sec-nhst-issues">
    <title>Some Issues to Consider</title>

    <p>
      What we've discussed in this chapter is the orthodox framework for null hypothesis significance
      testing (NHST). Understanding how NHST works is an absolute necessity since it has been the
      dominant approach to inferential statistics since its prominence in the early 20th century.
      It's what the vast majority of working scientists rely on for their data analysis, so even if
      you hate it, you need to know it. However, the approach is not without problems. There are
      several quirks in the framework, historical oddities in how it came to be, theoretical
      disputes over whether or not the framework is proper, and many practical traps for the unwary.
      Without going into much detail on this topic, it's worth briefly discussing a few of these
      issues.
    </p>

    <subsection xml:id="subsec-neyman-vs-fisher">
      <title>Neyman versus Fisher</title>

      <p>
        The first thing you should be aware of is that orthodox NHST is a mash-up of two somewhat
        different approaches to hypothesis testing, one proposed by Sir Ronald Fisher and the other
        proposed by Jerzy Neyman. The history is messy because Fisher and Neyman were real people
        whose opinions changed over time, and at no point did either of them offer <q>the definitive
        statement</q> of how we should interpret their work many decades later. That said, here's a
        quick summary of these two approaches.
      </p>

      <p>
        First, let's talk about Fisher's approach. Fisher assumed that you only had one hypothesis
        (the null), and what you want to do is find out if the null hypothesis is inconsistent with
        the data. From his perspective, what you should do is check to see if the data are
        <q>sufficiently unlikely</q> according to the null. In fact, if you remember back to our
        earlier discussion, that's how Fisher defines the <m>p</m>-value. According to Fisher, if
        the null hypothesis provided a very poor account of the data, you could safely reject it.
        But, since you don't have any other hypotheses to compare it to, there's no way of
        <q>accepting the alternative</q> because you don't necessarily have an explicitly stated
        alternative. That's more or less all that there was to it.
      </p>

      <p>
        In contrast, Neyman thought that the point of hypothesis testing was as a guide to action,
        and his approach was somewhat more formal than Fisher's. His view was that there are multiple
        things you could <em>do</em> (accept the null or accept the alternative), and the point of
        the test was to tell you which one the data support. From this perspective, it is critical
        to specify your alternative hypothesis properly. If you don't know the alternative
        hypothesis, then you don't know how powerful the test is or which action makes sense. His
        framework genuinely requires competition between different hypotheses. For Neyman, the
        <m>p</m> value didn't directly measure the probability of the data (or data more extreme)
        under the null; it was more of an abstract description about which <q>possible tests</q>
        were telling you to accept the null and which <q>possible tests</q> were telling you to
        accept the alternative.
      </p>

      <p>
        As you can see, what we have today is an odd mishmash of the two. We talk about having both
        a null hypothesis and an alternative (Neyman) but usually define the <m>p</m> value in terms
        of extreme data (Fisher), but we still have <m>\alpha</m> values (Neyman). Some statistical
        tests have explicitly specified alternatives (Neyman), but others are quite vague about it
        (Fisher). And, according to some people, we're not allowed to talk about accepting the
        alternative (Fisher). It's a mess.
      </p>

    </subsection>

    <subsection xml:id="subsec-bayesians-vs-frequentists">
      <title>Bayesians versus Frequentists</title>

      <p>
        Earlier in this chapter, we emphasised how you <em>cannot</em> interpret the <m>p</m> value
        as the probability that the null hypothesis is true. NHST is fundamentally a frequentist
        tool (see <xref ref="ch-probability"/>), and as such, it does not allow you to assign
        probabilities to hypotheses: the null hypothesis is either true or not. The Bayesian
        approach to statistics interprets probability as a degree of belief, so it's totally okay to
        say that there is a 10% chance that the null hypothesis is true: that's just a reflection of
        your degree of confidence in this hypothesis. You aren't allowed to do this within the
        frequentist approach. Remember, if you're a frequentist, a probability can only be defined
        in terms of what happens after a large number of independent replications (i.e. a long-run
        frequency). If this is your interpretation of probability, talking about the
        <q>probability</q> that the null hypothesis is true is complete gibberish.
      </p>

      <p>
        Most importantly, this <em>isn't</em> an ideological matter purely. If you decide that you
        are a Bayesian and are okay with making probability statements about hypotheses, you
        <em>must</em> follow the Bayesian rules for calculating those probabilities. We'll talk more
        about this in <xref ref="ch-bayes"/>, but for now, understand that <m>p</m> value is a
        <em>terrible</em> approximation to the probability that <m>H_0</m> is true. If what you
        want to know is the probability of the null, then the <m>p</m> value is not what you're
        looking for!
      </p>

    </subsection>

    <subsection xml:id="subsec-traps">
      <title>Traps</title>

      <p>
        As you can see, the theory behind hypothesis testing is a mess, and even now, there are
        arguments in statistics about how it <q>should</q> work. However, disagreements among
        statisticians are not our real concern here. Our real concern is practical data analysis.
        And while the <q>orthodox</q> approach to null hypothesis significance testing has many
        drawbacks, even an unrepentant Bayesian would agree that they can be useful if used
        responsibly. They usually give sensible answers, and you can use them to learn interesting
        things. Setting aside the various ideologies and historical confusions that we've discussed,
        the fact remains that the biggest danger in all of statistics is <em>thoughtlessness</em>.
        Not stupidity but thoughtlessness. The rush to interpret a result without thinking through
        what each test says about the data and checking whether that's consistent with how you've
        interpreted it. That's where the biggest trap lies.
      </p>

      <p>
        To give an example of this, consider the following example. Suppose we run the ESP study,
        and we've decided to analyse the data separately for the male and female participants. Of
        the male participants, 33 out of 50 guessed the card's colour correctly. This is a
        significant effect (<m>p = .03</m>). Of the female participants, 29 out of 50 guessed
        correctly. This is not a significant effect (<m>p = .32</m>). Upon observing this, it is
        extremely tempting for people to start wondering why there is a difference between males and
        females regarding their psychic abilities. However, this doesn't seem right. If you think
        about it, we haven't <em>actually</em> run a test that explicitly compares males to females.
        All we have done is compare males to chance (binomial test was significant) and compare
        females to chance (binomial test was non-significant). If we want to argue that there is a
        real difference between the males and the females, we should probably run a test of the null
        hypothesis that there is no difference! We can do that using a different hypothesis test,
        but when we do that, it turns out that we have no evidence that males and females are
        significantly different (<m>p = .54</m>). <em>Now</em> do you think that there's anything
        fundamentally different between the two groups? Of course not. What's happened here is that
        the data from both groups (male and female) are pretty borderline: by pure chance, one of
        them happened to end up on the magic side of the <m>p = .05</m> line, and the other one
        didn't. That doesn't imply that males and females are different. This mistake is so common
        that you should always be wary of it: the difference between significant and not-significant is <em>not</em>
        evidence of a real difference <mdash/> if you want to say that there's a difference between
        two groups, then you have to test for that difference!
      </p>

      <p>
        Think about <em>what</em> it is you want to test, <em>why</em> you want to test it, and
        whether or not the answers that your test gives could possibly make any sense in the real
        world.
      </p>

    </subsection>

  </section>

  <section xml:id="sec-hypothesis-testing-summary">
    <title>Summary</title>

    <p>
      Null hypothesis testing is one of the most ubiquitous elements of statistical theory. The vast
      majority of scientific papers report the results of some hypothesis test or another. As a
      consequence, it is almost impossible to get by in science without having at least a cursory
      understanding of what a <m>p</m>-value means, making this one of the most important chapters
      in the book. Here is a quick recap of the key ideas that we've talked about:
    </p>

    <ul>
      <li><p>Research hypotheses and statistical hypotheses. Null and alternative hypotheses (<xref ref="sec-hypotheses"/>).</p></li>
      <li><p>Type 1 and Type 2 errors (<xref ref="sec-error-types"/>)</p></li>
      <li><p>Test statistics and sampling distributions (<xref ref="sec-test-statistics"/>)</p></li>
      <li><p>Hypothesis testing as a decision making process (<xref ref="sec-decision-making"/>)</p></li>
      <li><p><m>p</m>-values as <q>soft</q> decisions (<xref ref="sec-pvalue"/>)</p></li>
      <li><p>Writing up the results of a hypothesis test (<xref ref="sec-reporting-results"/>)</p></li>
      <li><p>Effect size and power (<xref ref="sec-effect-size"/>)</p></li>
      <li><p>A few issues to consider regarding hypothesis testing (<xref ref="sec-nhst-issues"/>)</p></li>
    </ul>

    <p>
      Later in the book, in <xref ref="ch-bayes"/>, we'll revisit the theory of null hypothesis
      tests from a Bayesian perspective and introduce a number of new tools that you can use if you
      aren't particularly fond of the orthodox approach. But for now, though, we're done with the
      abstract statistical theory, and we can start discussing specific data analysis tools.
    </p>

  </section>

</chapter>
